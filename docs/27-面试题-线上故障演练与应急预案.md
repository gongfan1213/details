### 面试题：线上故障演练与应急预案

#### Q1：SSE 大面积断流如何应急？
**标准回答**：
- 处置：确认网关/代理策略变更（超时/缓冲/连接数），临时放宽 `proxy_read_timeout` 并关闭缓存；客户端开启快速重连与退避；后端临时降低心跳间隔。
- 根因定位：比对发布变更、观察 Nginx upstream/内核参数（`fs.file-max`、`net.core.somaxconn`）、连接数与 fd 使用率；检查后端线程池与阻塞点。

#### Q2：LLM 服务波动（高 5xx/高延迟）时的用户体验保障？
**标准回答**：
- 降级：切换到备选模型/网关（`llm.settings`），或改为非流式与短提示词；对无关紧要步骤跳过或以历史结果替代；明确提示用户“服务繁忙，稍后自动补全”。
- 缓冲：对已取得的中间产物先呈现（计划/部分结果），强调“处理中”，避免空白页面；对生成报告可延后生成并通过链接补发。

#### Q3：工具服务发生异常（代码执行/报告/搜索）如何止血？
**标准回答**：
- 快速止血：关闭对应工具开关，或在 `ToolCollection` 中临时移除；对任务编排层引导绕开该工具；对不可用工具在前端展示“临时不可用”。
- 调查：回放最近 `requestId` 的工具输入与输出；检查 `.env` 与外部依赖（搜索 Key、文件目录权限）。

#### Q4：文件服务被滥用（大文件/大量上传）如何限流？
**标准回答**：
- 限流：按 IP/用户/请求路径做速率限制；对二进制上传限制大小与并发；对预览/下载做缓存与 CDN；对临时文件设 TTL 定期清理。

#### Q5：演练脚本与演练频率如何制定？
**标准回答**：
- 演练场景：SSE 断流、LLM 降级、工具 500、文件 IO 饱和、端口冲突、Key 失效。
- 频率：双周小演练（单场景），季度综合演练（多场景串联）；每次演练形成 SOP/时间线/改进单。


