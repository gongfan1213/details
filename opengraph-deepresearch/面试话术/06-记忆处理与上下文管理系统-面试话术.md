# 记忆处理与上下文管理系统｜技术面试话术

## 一句话定位
- 将执行期 state 与长期 memory 分层管理，支持会话记忆、Agent 共享记忆与可检索语义记忆。

## 架构要点
- 上下文：`utils/context_manager.py`（Nova3）、`utils/loomi_context_manager.py`（Loomi）。
- 粒度：state（短期、可恢复）vs memory（长期、可检索）。
- 检索注入：进入写作/决策前，按 `query→retrieve→rerank→compress` 注入。
- Checkpoint：`agents/graph/redis_checkpoint.py` 最小可恢复点（thread/graph/step）。

## 难点与解决
- 串话与污染：会话级命名空间 + Agent 源标注 + 版本号推进。
- 体积膨胀：历史裁剪（时间窗/重要性）+ 去重压缩 + TTL。
- 恢复漂移：快照 + 幂等写/补偿；只回放无副作用步骤。

## 指标与收益
- 记忆命中率↑，token 成本↓；恢复成功率↑。

## 可扩展 & 高可用
- 记忆桶按 Agent/任务阶段划分；KV（Redis）与向量（Milvus）双存储。

## Demo 话术
- 展示一次写作任务如何在多轮对话中复用“打点/风格/证据”三类记忆。

## 追问与答法
- Q：如何做隐私保护？
  - A：PII 检测与掩码；敏感字段KMS加密；按租户隔离命名空间。
