# 流式响应与实时通信系统（SSE）｜技术面试话术

## 一句话定位
- 以 SSE 实时推送多Agent阶段事件与增量内容，提供“可见的过程”。

## 架构要点
- FastAPI + StreamingResponse；事件模型 `StreamEvent{type,source,payload}`。
- 事件类型：system/llm_chunk/tool_call/agent_action/error/complete。
- 断点回放：结合持久化流存储与检查点，支持“回放→实时续传”。

## 难点与解决
- 浏览器断线：心跳+自动重连；服务端检测断流及时清理。
- 顺序一致性：事件带序号与阶段字段，前端按节点与阶段聚合。
- 大模型分段：分块 flush，尾块对齐与 DONE 标识。

## 指标与收益
- 感知等待降低：首字时间 < 1s，用户留存更好。

## Demo 话术
- 打开前端 EventStream 面板，边跑边解释每类事件与其来源 Agent。

## 追问与答法
- Q：如何做回放？
  - A：会话ID索引历史事件，先推历史，再切实时通道；完成后输出 DONE。
