|æ¨¡å‹åç§°|ä¸»è¦ç‰¹ç‚¹|ä¸­æ–‡é¢†åŸŸè¡¨ç°|é€‚ç”¨åœºæ™¯|
| ---- | ---- | ---- | ---- |
|Qwen3-Embedding-8B|8Bå‚æ•°é‡ï¼Œå¤šè¯­è¨€SOTAï¼Œæ”¯æŒ100+è¯­è¨€ï¼Œé•¿æ–‡æœ¬ç†è§£ï¼ŒæŒ‡ä»¤æ”¯æŒï¼Œå¯è‡ªå®šä¹‰ç»´åº¦|ç›®å‰MTEBå¤šè¯­è¨€æ¦œå•ç¬¬ä¸€ï¼Œä¸­æ–‡æ€§èƒ½æä½³|å¯¹æ€§èƒ½è¦æ±‚æé«˜çš„é€šç”¨ä¸­æ–‡è¯­ä»»åŠ¡ï¼ŒRAGï¼Œéœ€è¦çµæ´»ç»´åº¦å’ŒæŒ‡ä»¤æ§åˆ¶çš„åœºæ™¯|
|BGE-M3|å¤šè¯­è¨€ï¼ˆ100+ï¼‰ï¼Œå¤šåŠŸèƒ½ï¼ˆç¨ å¯†/å¤šå‘é‡/ç¨€ç–æ£€ç´¢ï¼‰ï¼Œå¤šç²’åº¦ï¼ˆ8192 tokenï¼‰ï¼ŒæŒ‡ä»¤å¾®è°ƒ|åœ¨ä¸­æ–‡RAGå’Œé€šç”¨æ£€ç´¢ä»»åŠ¡ä¸­è¡¨ç°å‡ºè‰²|éœ€è¦å¤„ç†å¤šè¯­è¨€ã€é•¿æ–‡æœ¬ã€ä»¥å¤šç§æ£€ç´¢æ–¹å¼ï¼ˆæ··åˆæ£€ç´¢ï¼‰çš„ä¸­æ–‡RAGå’Œä¿¡æ¯æ£€ç´¢ç³»ç»Ÿ|
|BCEmbedding|åŒè¯­ï¼ˆä¸­/è‹±ï¼‰å’Œè·¨è¯­è¨€èƒ½åŠ›å¼ºï¼ŒRAGåŸºçŸ³ï¼ŒåŒç¼–ç å™¨ + äº¤å‰ç¼–ç å™¨ï¼Œé¢†åŸŸé€‚åº”æ€§å¼ºï¼Œæ— æŒ‡ä»¤|åœ¨ä¸­è‹±æ–‡åŒè¯­å’Œè·¨è¯­è¨€ä»»åŠ¡ä¸Šè¡¨ç°ä¼˜å¼‚ï¼Œå°¤å…¶é€‚åˆRAG|ä¸­è‹±æ–‡æ··åˆæˆ–è·¨è¯­è¨€åœºæ™¯ï¼ŒRAGå¼ºè°ƒé«˜æ•ˆå’Œç²¾ç¡®æ£€ç´¢|
|BGE-Large-Zh|ä¸­æ–‡ä¸“å±ä¼˜åŒ–ï¼Œ1024ç»´ï¼Œ512 tokenæœ€å¤§é•¿åº¦|ä¸­æ–‡è¯­ä¹‰ç†è§£å’Œæ£€ç´¢çš„å¼ºå¤§é€‰æ‹©|ä¸“æ³¨äºä¸­æ–‡çš„è¯­ä¹‰æœç´¢ã€ç›¸ä¼¼è®¡ç®—ã€æ–‡æœ¬åˆ†ç±»ç­‰ä»»åŠ¡|
|M3E-base|ä¸­è‹±æ–‡æ··åˆè®­ç»ƒï¼Œè½»é‡çº§ï¼ˆ110Må‚æ•°ï¼‰ï¼Œé«˜æ•ˆæ¨ç†ï¼ŒæŒ‡ä»¤æ•°æ®è®­ç»ƒ|ä¸­æ–‡æ–‡æœ¬åˆ†ç±»å’Œæ£€ç´¢æ–¹é¢æ€§èƒ½ä¼˜å¼‚|èµ„æºå—é™ä½†éœ€è¦ä¸­è‹±æ–‡æ··åˆå¤„ç†çš„åœºæ™¯ï¼Œå¿«é€Ÿæ¨ç†ã€é€šç”¨ä¸­æ–‡è¯­ä¹‰ä»»åŠ¡|
|Nomic Embed Text V1.5|å¤šè¯­è¨€ï¼ˆ100+ï¼‰ï¼Œé•¿åºåˆ—ï¼ˆ8192 tokenï¼‰ï¼ŒMatryoshkaçµæ´»ç»´åº¦ï¼Œå¤šæ¨¡æ€ï¼ˆä¸Visionå¯¹é½ï¼‰ï¼Œä»»åŠ¡ç±»å‹ä¼˜åŒ–ï¼Œå¼€æº|åœ¨ä¸­æ–‡é€šç”¨ä»»åŠ¡ä¸Šæœ‰ç«äº‰åŠ›ï¼Œä½†å¯èƒ½ä¸å¦‚ä¸­æ–‡ä¸“å±æ¨¡å‹|éœ€è¦å¤„ç†é•¿æ–‡æœ¬ã€å¤šè¯­è¨€ã€ä»¥çµæ´»ç»´åº¦é€‰æ‹©çš„é€šç”¨è¯­ä¹‰ä»»åŠ¡ï¼Œå¤šæ¨¡æ€éœ€æ±‚çš„åœºæ™¯|


1.å¯¹äºå¤–äººæ¥è¯´å‡ ä¹å®Œå…¨ç›¸åŒçš„æŸ¥è¯¢ï¼Œåœ¨é¢†åŸŸä¸“å®¶çœ‹æ¥æœ‰é‡å¤§åŒºåˆ«ï¼Œé€šç”¨åµŒå…¥æ¨¡å‹å¯èƒ½ä¼šå¿½ç•¥ç»†å¾®å·®åˆ«

2.å¦‚æœrerankeræ¨¡å‹æ²¡æœ‰ç»è¿‡ä¸“ä¸šæœ¯è¯­ï¼Œè¡Œä¸šé»‘è¯æˆ–è€…ç¼©ç•¥è¯­çš„è®­ç»ƒï¼Œå¯èƒ½ä¼šå°†ç›¸å…³çš„ä¿¡æ¯è¯¯åˆ¤ä¸ºä¸ç›¸å…³çš„

3.å¤§è¯­è¨€æ¨¡å‹å¯èƒ½å¯¹ç‰¹å®šé¢†åŸŸä¸‹çš„ä¸“ä¸šç§°å‘¼ï¼Œç¼©å†™æˆ–è€…è¶…å‡ºå…¶è®­ç»ƒæ•°æ®èŒƒå›´ä¹‹å¤–çš„çŸ¥è¯†äº§ç”Ÿè®¤çŸ¥æ··ä¹±

## 4.2.2.1 ç¡®å®šä¸šåŠ¡é¢†åŸŸ 
æ„å»ºè¯„ä¼°æ•°æ®é›†çš„ç¬¬ä¸€æ­¥æ˜¯ç¡®å®šä¸šåŠ¡èŒƒå›´ï¼Œä¹Ÿå°±æ˜¯å…ˆææ˜ç™½ä½ æ•°æ®é›†ç”¨åœ¨ä»€ä¹ˆåœºæ™¯ï¼Ÿæ¯”å¦‚ï¼š
- æ³•å¾‹é—®ç­”åŠ©æ‰‹ï¼Ÿâ†’ æ„å»ºæ³•å¾‹ç±»æ•°æ®é›† 
- é‡‘èèµ„è®¯æœºå™¨äººï¼Ÿâ†’ æ„å»ºé‡‘èç±»æ•°æ®é›† 
- ä¼ä¸šå†…éƒ¨æ–‡æ¡£åŠ©æ‰‹ï¼Ÿâ†’ æ„å»ºå…¬å¸çŸ¥è¯†åº“æ•°æ®é›† 

ğŸ’¡æ³¨æ„ï¼šåªæœ‰èšç„¦æ ¸å¿ƒä¸šåŠ¡åœºæ™¯ï¼Œæ„å»ºçš„æ•°æ®é›†æ‰æœ‰æ„ä¹‰ã€‚ 

è™½ç„¶ç¬¬ä¸€æ­¥çœ‹èµ·æ¥å¾ˆå‚»ï¼Œä½†åˆ«ä¸ä¿¡ï¼Œæˆ‘è¿˜çœŸè§è¿‡æœ‰äº›å¤§èªæ˜çæçš„ï¼Œè€Œä¸”è¿˜æ˜¯ä¸€æµå¤§å‚ã€‚ 

## 4.2.2.2 å‡†å¤‡é—®é¢˜ç­”æ¡ˆ 
ç¡®å®šä¸šåŠ¡é¢†åŸŸåï¼Œç¬¬äºŒæ­¥æˆ‘ä»¬éœ€è¦å‡†å¤‡é—®é¢˜å’Œç­”æ¡ˆã€‚æ ·ä¾‹å¦‚ä¸‹ï¼š 

**ä»£ç å—** 
```
{
  "question": "ã€Šå–œå‰§ä¹‹ç‹ã€‹ä¸­æŸ³é£˜é£˜ä¸€å¤œæƒ…åå¯¹å°¹å¤©ä»‡è¯´äº†ä»€ä¹ˆï¼Ÿ", 
  "answer": "åœ¨ç”µå½±ã€Šå–œå‰§ä¹‹ç‹ã€‹ä¸­ï¼Œä¸€å¤œæƒ…ä¹‹åï¼ŒæŸ³é£˜é£˜å¯¹å°¹å¤©ä»‡è¯´ï¼šâ€œä½ ä¸ä¼šçœŸçš„ä»¥ä¸ºæˆ‘å–œæ¬¢ä½ å§ï¼Ÿå¤§å®¶éƒ½
``` 


å‡†å¤‡é—®é¢˜å’Œç­”æ¡ˆçš„æ–¹æ³•é€šå¸¸æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š

å‡†å¤‡é—®é¢˜å’Œç­”æ¡ˆçš„æ–¹æ³•é€šå¸¸æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š
1. **æ‰‹åŠ¨æ„é€ **ã€‚ä½ éœ€è¦è·Ÿä¸šåŠ¡ä¸“å®¶åˆä½œï¼Œç¼–å†™é—®é¢˜å’Œç­”æ¡ˆï¼Œå¹¶ç¡®ä¿å†…å®¹æ¸…æ™°å’Œæƒå¨ï¼Œå¹¶æ ‡æ˜å‡ºå¤„
2. **å¯»æ‰¾å¼€æºæ•°æ®é›†**ã€‚å¯ä»¥å‚è€ƒä¸€äº›å¼€æºçš„ QA æ•°æ®é›†ï¼Œæ¯”å¦‚ï¼š

|æ•°æ®é›†|é€‚ç”¨é¢†åŸŸ|ç®€ä»‹|
| ---- | ---- | ---- |
|Natural Questions|é€šç”¨|æ¥è‡ª Google æœç´¢é—®é¢˜|
|HotpotQA|å¤šè·³é—®ç­”|æœ‰æ”¯æŒæ–‡æ¡£å’Œç­”æ¡ˆ|
|SQUAD|é˜…è¯»ç†è§£|æ ‡æ³¨ç²¾ç¡®ç­”æ¡ˆç‰‡æ®µ|
|ï¼ˆæ­¤å¤„å› æ˜¾ç¤ºä¸å…¨ï¼ŒåŸå†…å®¹éš¾å®Œæ•´å‘ˆç° ï¼‰|ï¼ˆæ˜¾ç¤ºä¸å…¨ ï¼‰|é‡‘èæ–‡æœ¬é—®ç­”å¯¹|
|ï¼ˆæ˜¾ç¤ºä¸å…¨ ï¼‰|ï¼ˆæ˜¾ç¤ºä¸å…¨ ï¼‰|æ¥è‡ª Reddit| 

è¿™é‡Œä¹Ÿåˆ†äº«ä¸‹æˆ‘ä»¥å‰åšåŒ»å­¦æ¨¡å‹æ—¶å‚è€ƒäº†ä¸€äº›æ•°æ®é›†ï¼š

## 4.2.2.3 æ ‡æ³¨æ”¯æŒæ–‡æ¡£ 

é—®é¢˜ç­”æ¡ˆå‡†å¤‡å®Œæ¯•åï¼Œç¬¬ä¸‰æ­¥æˆ‘ä»¬éœ€è¦æ ‡æ³¨â€œæ”¯æŒæ–‡æ¡£â€ã€‚ 

è¯¥æ­¥éª¤æ˜¯â€œRAG é»„é‡‘æ•°æ®é›†â€æœ€å…³é”®çš„éƒ¨åˆ†ï¼ 

å®ƒæœ€ç»ˆä½“ç°åœ¨æ•°æ®ç»“æ„çš„ suppo 

```json
{
  "question": "ã€Šå–œå‰§ä¹‹ç‹ã€‹ä¸­æŸ³é£˜é£˜ä¸€å¤œæƒ…åå¯¹å°¹å¤©ä»‡è¯´äº†ä»€ä¹ˆï¼Ÿ",
  "answer": "åœ¨ç”µå½±ã€Šå–œå‰§ä¹‹ç‹ã€‹ä¸­ï¼Œä¸€å¤œæƒ…ä¹‹åï¼ŒæŸ³é£˜é£˜å¯¹å°¹å¤©ä»‡è¯´ï¼šâ€œä½ ä¸ä¼šçœŸçš„ä»¥ä¸ºæˆ‘å–œæ¬¢ä½ å§ï¼Ÿå¤§å®¶éƒ½æ˜¯æˆå¹´â€
  "supporting_docs": [
    "ç¬¬äºŒå¤©æ¸…æ™¨ï¼ŒæŸ³é£˜é£˜çœ‹ç€å°¹å¤©ä»‡è¯´ï¼šâ€˜ä½ ä¸ä¼šçœŸçš„ä»¥ä¸ºæˆ‘å–œæ¬¢ä½ å§ï¼Ÿå¤§å®¶éƒ½æ˜¯æˆå¹´äººï¼Œç©ç©è€Œå·²ã€‚â€™å°¹å¤©ä»‡å¬åæ„£ä½",
    "å°¹å¤©ä»‡ä»åºŠä¸Šåèµ·ï¼Œåˆšæƒ³è¯´è¯ï¼Œå´è¢«æŸ³é£˜é£˜æ‰“æ–­ã€‚å¥¹åˆ»æ„ç”¨è½»æ¾çš„è¯­æ°”æ©é¥°è‡ªå·±çš„å¤æ‚æƒ…ç»ªã€‚",
    "è¿™ä¸ªæ¡¥æ®µå±•ç°äº†ä¸¤äººæƒ…æ„Ÿçš„é”™ä½ï¼Œå°¹å¤©ä»‡è®¤çœŸæŠ•å…¥ï¼Œè€ŒæŸ³é£˜é£˜åˆ™ç”¨é˜²å¤‡å’Œè‡ªå˜²éšè—å†…å¿ƒã€‚"
  ],
  "doc_ids": ["scene_26", "scene_26_note", "analysis_emotion_26"],
  "metadata": {
    "movie": "å–œå‰§ä¹‹ç‹",
    "characters": ["å°¹å¤©ä»‡", "æŸ³é£˜é£˜"],
    "scene": "ä¸€å¤œæƒ…å",
    "emotion": "æƒ…æ„Ÿé”™ä½ / å†·æ¼ æ©é¥°",
    "difficulty": "è¾ƒé«˜"
  }
}
```
å…³äºæ•°æ®é›†çš„ doc_ids å’Œ metadata å­—æ®µï¼Œå¤§å®¶å¯ä»¥æŒ‰ç…§è‡ªå·±å®é™…éœ€è¦è¿›è¡Œæ ‡æ³¨ã€‚ 
è‡ªæ­¤ï¼Œé»„é‡‘è¯„ä¼°æ•°æ®é›†æ„å»ºå®Œæ¯•ã€‚ 


ä»è¿™æ¡æ•°æ®æ ·æœ¬æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š

- æ•°æ®ç»“æ„å®Œæ•´ï¼šè¿™æ¡æ•°æ®æœ‰é—®é¢˜ã€æœ‰ç­”æ¡ˆã€æœ‰å‡ºå¤„ã€æœ‰å‡ºå¤„ç´¢å¼•ï¼Œç”šè‡³è¿˜æœ‰å…ƒæ•°æ®è¿‡æ»¤

å®šä¹‰è¯„ä¼°æŒ‡æ ‡-ã€‹æ„å»ºé»„é‡‘è¯„ä¼°æ•°æ®é›†-ã€‰æ£€ç´¢è¯„ä¼°-ã€‹ç”Ÿæˆè¯„ä¼°-ã€‰ç«¯åˆ°ç«¯è¯„ä¼°

## 4.2.2.4 æ•°æ®è´¨é‡æ ¡éªŒ 
è¯„ä¼°æ•°æ®é›†æ„å»ºå®Œæ¯•åï¼Œç¬¬å››æ­¥è¿›å…¥æ•°æ®é›†çš„è´¨æ£€é˜¶æ®µï¼Œè¯¥é˜¶æ®µå¾€å¾€éœ€è¦å¤šè§’è‰²å‚ä¸ï¼Œæ¯”å¦‚å®¢æˆ·ã€ä¸šåŠ¡ä¸“å®¶ã€å®¢æœã€ç®—æ³•ä¸“å®¶ã€å¤§æ•°æ®ä¸“å®¶ç­‰ï¼Œæ›´å¤šç›¸å…³è§’è‰²ä»‹å…¥ï¼Œæ›´å¤šè§†è§’å…³æ³¨ï¼Œæ›´å®¹æ˜“å°½æ—©å‘ç°é—®é¢˜ã€‚ 

æ•°æ®é›†è´¨æ£€é˜¶æ®µéœ€è¦åšä¸‹é¢å‡ ä»¶äº‹ï¼š| 
- æ£€æŸ¥é—®é¢˜çš„ç­”æ¡ˆæ˜¯å¦å‡†ç¡®ã€è§„èŒƒï¼Ÿï¼ˆç®€å•è¯´å°±æ˜¯æ•°æ®å‡†ä¸å‡†ç¡®ï¼‰ 
- æ ¹æ®æŸ¥è¯¢æ˜¯å¦å¯ä»¥æ¨å¯¼å‡ºç­”æ¡ˆï¼Ÿï¼ˆç®€å•è¯´å°±æ˜¯æ•°æ®é€»è¾‘æ˜¯å¦åˆç†ï¼‰ 
- æ•°æ®é›†æ˜¯å¦å®Œæ•´ã€æ˜¯å¦è¦†ç›–ä¸»è¦ä¸šåŠ¡åœºæ™¯ã€æ˜¯å¦æ”¯æŒä¸åŒç±»å‹é—®é¢˜ï¼Ÿï¼ˆç®€å•è¯´å°±æ˜¯æ•°æ®å®Œä¸å®Œæ•´ï¼‰ 
- æ˜¯å¦å­˜åœ¨å†—ä½™æˆ–å«ç³Šå†…å®¹ï¼Ÿï¼ˆç®€å•è¯´å°±æ˜¯æ•°æ®å¹²ä¸å¹²å‡€ï¼‰ 

æ•°æ®é›†è´¨æ£€ä¸€èˆ¬åšæ³•æ˜¯äººå·¥å’Œå¤§æ¨¡å‹ç›¸ç»“åˆçš„æ–¹å¼ã€‚å¦‚æœè§‰å¾—ä¸€ä¸ªå¤§æ¨¡å‹ä¸å‡†ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘å¤šä¸ªå¤§æ¨¡å‹ä¸€èµ·è¯„ä¼°ï¼Œç„¶åå…±è¯†å‡ºç»“æœã€‚ 

## 4.2.2.5 é»„é‡‘æ•°æ®ä¸¾ä¾‹ 
æ„å»ºé»„é‡‘è¯„ä¼°æ•°æ®é›†çš„æµç¨‹å·²åŸºæœ¬ä»‹ç»å®Œæ¯•ã€‚ 
ä¸‹é¢ï¼Œæˆ‘å¸¦å¤§å®¶å†çœ‹ä¸‹è¿™æ¡æ•°æ®æ ·æœ¬ï¼Œæˆ‘å†è§£é‡Šä¸‹ä¸ºä»€ä¹ˆæˆ‘è®¤ä¸ºå®ƒæ˜¯ä¸€æ¡â€œé»„é‡‘â€æ•°æ®ï¼š 

- é—®é¢˜çœŸå®è‡ªç„¶ï¼šå®ƒæ¨¡æ‹Ÿäº†äººæ€§åŒ–æé—®ï¼Œå¹¶éç™¾ç§‘ä¹¦å¼çš„æé—®ï¼Œæ¯”å¦‚ï¼šâ€œæŸ³é£˜é£˜æ˜¯è°â€ï¼Ÿ 
- é—®é¢˜ç­”æ¡ˆå‡†ç¡®ï¼šå®ƒå¼•ç”¨äº†ç”µå½±å…³é”®è¯ï¼Œè§£é‡Šæƒ…æ„ŸåŠ¨æœºï¼Œå†…å®¹å¿ å®ã€‚ 
- æ”¯æŒæ–‡æ¡£å®Œæ•´ï¼šæ”¯æŒæ–‡æ¡£å°±æ˜¯ç­”æ¡ˆå‡ºå¤„ã€‚å®ƒé€‰è‡ªç”µå½±å¯¹ç™½å’Œå‰§æƒ…æå†™ï¼Œæ”¯æŒæ£€ç´¢ã€‚ 
- å¯è¯„ä¼°æ€§å¼ºï¼šå¯ä»¥æ£€éªŒç³»ç»Ÿæ˜¯å¦æ£€ç´¢åˆ°å°è¯åœºæ™¯ã€æ˜¯å¦ç”Ÿæˆå¿ å®å›ç­”ã€‚ 

å½“ç„¶ï¼Œå…³äºé»„é‡‘æ•°æ®å†…å®¹ï¼Œä¸åŒä¸šåŠ¡é¢†åŸŸå¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«ã€‚ 

è¿™é‡Œéå¸¸æ¬¢è¿å¤§å®¶å„æŠ’å·±è§ï¼Œç»“åˆå®é™…å·¥ä½œå’Œå­¦ä¹ åœºæ™¯ï¼Œåœ¨è¯„è®ºåŒºæˆ–å¼¹å¹•åŒºè¡¨è¾¾è‡ªå·±çš„æƒ³æ³•å’Œè§‚ç‚¹ã€‚ 

### 4.2.2.5 é»„é‡‘æ•°æ®æ‰©å±• 
æœ‰æ—¶ï¼Œå½“ä½ æ„å»ºå‡ºä¸€æ¡è‡ªè®¤ä¸ºâ€œå®Œç¾â€çš„é»„é‡‘æ•°æ®åï¼Œä½ å®Œå…¨å¯ä»¥è¶çƒ­æ‰“é“ï¼Œç»§ç»­é¡ºç€è¿™æ¡é»„é‡‘æ•°æ®çš„æ€è·¯ï¼Œæ‰©å±•å‡ºæ›´å¤šé»„é‡‘æ•°æ®å‡ºæ¥ã€‚ 

æ¯”å¦‚æˆ‘ä»¬çš„é»„é‡‘æ•°æ®æ˜¯ï¼šâ€œæŸ³é£˜é£˜ä¸€å¤œæƒ…åå¯¹å°¹å¤©ä»‡è¯´äº†ä»€ä¹ˆï¼Ÿâ€ã€‚ 

ä½ å®Œå…¨å¯ä»¥ç»§ç»­æ„å»ºä¸‹åˆ—åœºæ™¯ï¼Œæ¯”å¦‚ï¼š
- å°¹å¤©ä»‡åœ¨æµ·å²¸è¾¹ï¼Œå‘æŸ³é£˜é£˜è¡¨ç™½æ—¶è¯´äº†ä»€ä¹ˆï¼Ÿ 
- æŸ³é£˜é£˜åœ¨è®¡ç¨‹è½¦ä¸­å“­åˆ°å´©æºƒæ—¶çš„åŠ¨ä½œå’Œæƒ…ç»ªï¼Ÿ 
- åæ¥é¢è¯•â€¦â€¦ï¼ˆå†…å®¹æ˜¾ç¤ºä¸å…¨ ï¼‰ 

ç­‰ç­‰ã€‚é€šè¿‡è¿™ç§æŠ€å·§ï¼Œä½ ä¼šå‘ç°æ‰€è°“æ•°æ®é›†æ„å»ºï¼Œå¹¶éæ— ä¸­ç”Ÿæœ‰ç¼–é€ ï¼Œè€Œæ˜¯é¡ºç†æˆç« ã€‚ 

è¿™ç§æ‰©å±•æ€è·¯åœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸­éå¸¸æœ‰ç”¨ï¼Œç”šè‡³å¯ä»¥æ¼”è¿›æˆä¸Šä¸‹æ–‡ç›¸å…³ã€ç”šè‡³æ˜¯æ¨ç†å‹é»„é‡‘æ•°æ®ã€‚

### 4.2.3 æ„å»ºæ•°æ®é›†æœ€ä½³å®è·µ 
æœ€åï¼Œæˆ‘å†ä»‹ç»ä¸‹æ„å»ºè¯„ä¼°é»„é‡‘æ•°æ®é›†çš„ä¸€äº›å…¶ä»–æŠ€å·§ã€‚ 

#### æ•°é‡ä¸Š 
å¯ä»¥å…ˆæ”¶é›† 10 - 50 æ¡æ•°æ®æ ·æœ¬ã€‚æ¯æ¡æ ·æœ¬åŒ…æ‹¬ï¼š
- é—®é¢˜ 
- æ ‡å‡†ç­”æ¡ˆ 
- 2 - 3 æ¡æ”¯æŒæ–‡æ¡£æ®µè½ 
- æ–‡æ¡£æ®µè½çš„ç´¢å¼• ID 
- å…ƒæ•°æ® 

æœ‰äº†è¿™äº›æ•°æ®æ ·æœ¬ï¼Œåç»­ä½ å°±å¯ä»¥ç”¨æ¥ï¼š
- è¯„ä¼°æ£€ç´¢å™¨æ˜¯å¦å‘½ä¸­æ”¯æŒæ–‡æ¡£ 
- è¯„ä¼°å¤§æ¨¡å‹ç”Ÿæˆæ˜¯å¦åŸºäºæ”¯æŒæ–‡æ¡£ã€æ˜¯å¦åç¦»äº‹å®ï¼Œæ˜¯å¦è´´åˆæ ‡å‡†ç­”æ¡ˆ 

#### æ•°æ®æ ·æœ¬é€‰æ‹©ä¸Š 
ä¹Ÿæœ‰ä¸€äº›æŠ€å·§ã€‚æ¯”å¦‚ï¼š
- âœ… ä¼˜å…ˆé€‰æ‹©é«˜é¢‘é—®é¢˜ï¼ˆæ¯”å¦‚ FAQï¼‰ 
- âœ… é—®é¢˜å°½é‡è‡ªç„¶ï¼Œç¬¦åˆçœŸäººå£å» 
- âœ… æ–‡æ¡£ç‰‡æ®µä¸è¦å¤ªé•¿ï¼Œè¿™æ ·å¯ä»¥é¿å…ä¸å¿…è¦çš„å™ªéŸ³ 
- âœ… ç­”æ¡ˆè¦èƒ½ä»æ”¯æŒæ–‡æ¡£ä¸­â€œæ¨å‡ºâ€ï¼Œä¸èƒ½è„±ç¦»äº‹å®
Ã— å°½é‡åˆ«é€‰æ‹©â€œå¸¸è¯†é¢˜â€ï¼Œè€Œä¸”è¦ç¡®ä¿æ•°æ®è´¨é‡è¿‡å…³ 

### å·¥å…·ä½¿ç”¨ä¸Š 
æœ€å¥½èµ°ç»„åˆæ­é…è·¯çº¿ã€‚æ¯”å¦‚ï¼š
- âœ… ä½¿ç”¨ Excel / Notion æ‰‹åŠ¨æ ‡æ³¨å°æ‰¹é‡æ•°æ®ï¼Œè¿™ç§è½»é‡ä½¿ç”¨ä½“éªŒå‹å¥½ï¼Œæ²¡æœ‰å·¥å…·å­¦ä¹ æ›²çº¿ 
- âœ… ä½¿ç”¨ Label Studio å¼€æºæ•°æ®æ ‡æ³¨å¹³å°ï¼Œæ”¯æŒæ–‡æ¡£ã€é—®é¢˜å’Œé«˜äº®æ ‡æ³¨ 
- âœ… ä½¿ç”¨ GPT-4 / Claude ç­‰å¤§æ¨¡å‹ï¼Œå…ˆå¸®ä½ ç”Ÿæˆåˆæ­¥ QA å¯¹ï¼Œäººå·¥å®¡æ ¸åå†ç”¨ 
- âœ… ä½¿ç”¨ Haystack / LlamaIndexï¼Œé€šè¿‡æ£€ç´¢è·å–æ”¯æŒæ–‡æ¡£ã€‚é€šè¿‡åŠè‡ªåŠ¨è·å–æ•°æ®é›†æ–¹å¼ï¼ŒåŠ é€Ÿæ ‡æ³¨æµç¨‹
- 

### 4.3 æ£€ç´¢è¯„ä¼°
ä»‹ç»å®Œå¦‚ä½•æ„å»ºé»„é‡‘æ•°æ®é›†åï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬è¿›å…¥åˆ° RAG è¯„ä¼°æµç¨‹çš„ç¬¬ä¸‰ä¸ªç¯èŠ‚â€”â€”æ£€ç´¢è¯„ä¼°ã€‚ 

æ£€ç´¢è¯„ä¼°çš„ç›®æ ‡å°±æ˜¯è¯„ä¼°æ ¹æ®æŸ¥è¯¢ä»**çŸ¥è¯†åº“**æ£€ç´¢ç»“æœæ•´ä¸ªè¿‡ç¨‹æ˜¯å¦æˆåŠŸã€‚ 

æ³¨æ„æˆ‘è¿™é‡Œè¯´çš„æ˜¯â€œçŸ¥è¯†åº“â€ï¼Œè€Œéå‘é‡åº“ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ— è®ºæ•°æ®åº“ã€æœç´¢å¼•æ“ã€æ–‡ä»¶ç³»ç»Ÿã€å‘é‡åº“ã€ç½‘ç»œè¿˜æ˜¯ä»»ä½•ä»¥å­˜å‚¨æ•°æ®çš„åœ°æ–¹ï¼Œéƒ½å±äºçŸ¥è¯†åº“çš„èŒƒç•´ã€‚RAG æ˜¯æ£€ç´¢å¢å¼ºç”Ÿæˆï¼Œå®ƒå¹¶æ²¡æœ‰å¼ºåˆ¶çŸ¥è¯†åº“ä¸€å®šæ˜¯å‘é‡åº“ï¼Œè¿™é‡Œå¤§å®¶è¦æ³¨æ„ï¼Œåƒä¸‡ä¸è¦æŠŠè·¯èµ°çª„äº†ã€‚ 

#### 4.3.1 æ£€ç´¢è¯„ä¼°å‡†å¬ç‡å®šä¹‰ 
åš RAG è¿™ä¹ˆä¹…ï¼Œæˆ‘è®¤ä¸ºæ£€ç´¢è¯„ä¼°æ˜¯å…¨è¯„ä¼°æµç¨‹é‡Œï¼Œæœ€å›°éš¾çš„ç¯èŠ‚ï¼Œä¹Ÿæ˜¯æœ€æœ‰æŠ€æœ¯æŒ‘æˆ˜çš„ç¯èŠ‚ã€‚ 

å®¢è§‚æ¥è¯´ï¼Œå¬å›ç‡ã€å‡†ç¡®ç‡ã€å‘½ä¸­ç‡ã€MRRï¼ˆå¹³å‡å€’æ•°æ’åï¼‰ã€NDCGï¼ˆå½’ä¸€åŒ–æŠ˜æ‰£ç´¯ç§¯å¢ç›Šï¼‰ç­‰æŒ‡æ ‡éå¸¸é‡è¦ã€‚è®²èµ·è¿™äº›æŒ‡æ ‡ä»¥åŠèƒŒåçš„æ•°å­¦å…¬å¼ï¼Œä¼šè®©æˆ‘å……æ»¡æˆå°±æ„Ÿï¼Œæ¯•ç«Ÿç›´å‡»åº•å±‚é€»è¾‘ï¼Œæœ€æ¥è¿‘çœŸç†ã€‚ 

ä½†æˆ‘ç›¸ä¿¡ï¼Œå¦‚æœæˆ‘çœŸè¿™ä¹ˆåšäº†ï¼Œè‚¯å®šä¼šåŠé€€å¤§å¤šæ•°äººï¼Œå¤§å®¶è‚¯å®šç›´æ¥å…³é—­æˆ‘çš„è§†é¢‘èµ°äººã€‚ 

æ‰€ä»¥ï¼Œæ·±è°™ä¸–æ•…çš„æˆ‘ï¼Œä¼šæ”¶èµ·é‚£ä»½å¥½ä¸ºäººå¸ˆçš„å–„æ„ï¼Œå¾ˆå¤šæ•°å­¦çŸ¥è¯†åªä¼šç‚¹åˆ°ä¸ºæ­¢ã€‚

å¬å›ç‡recall

recall=ï¼ˆæ£€ç´¢å‡ºçš„ç›¸å…³æ–‡æ¡£æ•°é‡ï¼‰/ï¼ˆæ‰€æœ‰å®é™…å­˜åœ¨çš„ç›¸å…³æ–‡æ¡£çš„æ•°é‡ï¼‰

### 4.3.3 æ£€ç´¢è¯„ä¼°æŒ‡æ ‡ç¤ºä¾‹
è®²å®Œå‡†ç¡®ç‡å’Œå¬å›ç‡ç†è®ºåï¼Œä¸ºäº†åŠ æ·±å¤§å®¶ç†è§£ï¼Œæˆ‘å†ä¸¾ä¸ªå®é™…ä¾‹å­ã€‚
å…ˆçœ‹ä¸‹é¢çš„è¡¨æ ¼ã€‚æ³¨æ„ï¼Œä¸‹è¡¨æŒ‡æ ‡åé¢çš„kä»£è¡¨å®é™…æ£€ç´¢è¿”å›çš„æ–‡æ¡£ä¸ªæ•°ã€‚

| æŒ‡æ ‡å | ä¸­æ–‡è§£é‡Š | ä¸¾ä¾‹ | ç”¨é€” |
| --- | --- | --- | --- |
| Recall@k | å‰kä¸ªæ£€ç´¢ç»“æœä¸­æ˜¯å¦æœ‰ç›¸å…³æ–‡æ¡£ | æ£€ç´¢å‡ºå‰5ä¸ªæ®µè½ï¼Œå…¶ä¸­1ä¸ªæ˜¯ç­”æ¡ˆå‡ºå¤„â†’Recall@5 = 1ï¼ˆå‘½ä¸­ï¼‰ | æ£€æŸ¥æœ‰æ²¡æœ‰è¿”å› |
| Precision@k | å‰kä¸ªæ£€ç´¢ç»“æœä¸­æœ‰å¤šå°‘æ˜¯â€œçœŸæ­£ç›¸å…³â€çš„ï¼Ÿ | æ£€ç´¢å‡º5ä¸ªæ®µè½ï¼Œåªæœ‰2ä¸ªçœŸæ­£æœ‰å…³â†’Precision@5 = 0.4 | æŸ¥å¾—å‡†ä¸å‡† |
| Hit@k | å‰kä¸ªç»“æœä¸­æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ªå‘½ä¸­æ­£ç¡®æ–‡æ¡£ï¼Ÿï¼ˆå‘½ä¸­=1ï¼Œå¦åˆ™=0ï¼‰ | è‹¥æ­£ç¡®æ®µè½æ’åœ¨ç¬¬4åâ†’Hit@5 = 1 | å¸¸ç”¨äºç²—ç•¥ç»Ÿè®¡æ£€ç´¢å‘½ä¸­ç‡ |
| MRR (Mean Reciprocal Rank) | æ­£ç¡®æ–‡æ¡£æ’åè¶Šé å‰ï¼Œåˆ†æ•°è¶Šé«˜ | æ­£ç¡®ç­”æ¡ˆæ’åœ¨ç¬¬1åå¾—åˆ†1ï¼Œç¬¬2åå¾—åˆ†0.5ï¼Œä»¥æ­¤ç±»æ¨ | è¡¡é‡æ­£ç¡®ç­”æ¡ˆæ’åºè´¨é‡ |
| NDCG@kï¼ˆé€‰ç”¨ï¼‰ | ç»“åˆç›¸å…³æ€§å’Œæ’åçš„åŠ æƒè¯„ä»· | æ¯”MRRæ›´ç»†è‡´ï¼Œé€‚ç”¨äºæœ‰å¤šä¸ªç›¸å…³æ–‡æ¡£ | å¤§å‹ç³»ç»Ÿä¸­ä½¿ç”¨å¤šä¸€äº› | 

åˆ—è¡¨äº†è§£å®Œæ¯•åï¼Œä¸‹é¢æˆ‘ä»¬å¼•å…¥ã€Šå–œå‰§ä¹‹ç‹ã€‹RAGç³»ç»Ÿã€‚ 

æˆ‘ä»¬å…ˆé—®é—®é¢˜ã€‚ 
é—®é¢˜ï¼ˆqueryï¼‰ï¼šâ€œæŸ³é£˜é£˜è¯´â€˜ç©ç©è€Œå·²â€™æ˜¯åœ¨ä»€ä¹ˆæƒ…å¢ƒä¸‹ï¼Ÿâ€ 

è¯¥é—®é¢˜ç­”æ¡ˆåœ¨çŸ¥è¯†åº“ä¸­æ˜¯çœŸå®å­˜åœ¨çš„ã€‚å¦‚ä¸‹ï¼š 
æŸ³é£˜é£˜ï¼šâ€œä½ ä¸ä¼šçœŸâ€¦â€¦ 
åœºæ™¯æè¿°ï¼šå‘ç”Ÿåœ¨ä¸¤äººä¸€å¤œæƒ…åçš„æ¸…æ™¨ï¼ŒæŸ³é£˜é£˜è£…ä½œå†·æ¼ å›åº”å°¹å¤©ä»‡çš„è®¤çœŸã€‚ 

å½“æˆ‘ä»¬æŠŠé—®é¢˜è¾“å…¥RAGç³»ç»Ÿåï¼Œç³»ç»Ÿåœ¨å‰§æœ¬çŸ¥è¯†åº“ä¸­è¿›è¡Œæ£€ç´¢ï¼Œéšåè¿”å›5ä¸ªæ–‡æ¡£ã€‚4


|æŒ‡æ ‡|ç»“æœ|è¯´æ˜|
| ---- | ---- | ---- |
|Recall@5|= 1ï¼ˆå‘½ä¸­ï¼‰|å‰5ä¸ªæ£€ç´¢ç»“æœä¸­æœ‰ç›¸å…³æ–‡æ¡£|
|Precision@5|1/5 = 0.2ï¼ˆåªæœ‰1ä¸ªç›¸å…³ï¼‰|å‰5ä¸ªç»“æœé‡ŒçœŸæ­£ç›¸å…³çš„å æ¯”| 
|Hit@1|= 0ï¼ˆä¸åœ¨ç¬¬ä¸€ä½ï¼‰|å‰1ä¸ªç»“æœä¸­æ— å‘½ä¸­æ­£ç¡®æ–‡æ¡£| 
|MRR|1/4 = 0.25ï¼ˆæ­£ç¡®ç­”æ¡ˆæ’ç¬¬4ï¼‰|å› æ­£ç¡®ç­”æ¡ˆæ’ç¬¬4ï¼Œåˆ†æ•°ä¸º1/4| 

ç”±è¿™ä¸ªè¯„ä¼°ç»“æœï¼Œæˆ‘ä»¬å¾—å‡ºçš„ç»“è®ºæ˜¯ï¼š
- æ£€ç´¢å™¨å‹‰å¼ºå‘½ä¸­äº†ç­”æ¡ˆï¼ˆRecall è¿˜è¡Œï¼‰ 
- ä½†è´¨é‡å¾ˆå·®ï¼Œæ’åºä¸å¥½ï¼ˆPrecision å’Œ MRR å¾ˆä½ï¼‰ 

### 4.3.4 æ£€ç´¢è¯„ä¼°å®æˆ˜ 
ä»‹ç»å®Œä¸Šé¢æ¡ˆä¾‹ï¼Œå…¶å®æˆ‘ä»¬å°±å·²ç»å¤§ä½“çŸ¥é“æ£€ç´¢è¯„ä¼°å¦‚ä½•å®ç°äº†ã€‚åªéœ€ä¸‹é¢ä¸‰æ­¥ï¼š
- âœ…ç¬¬ä¸€æ­¥ï¼šå…ˆæ„å»ºæ£€ç´¢é»„é‡‘æ•°æ®é›†ã€‚è¿™ä¸€æ­¥æˆ‘ä»¬åœ¨ä¸Šé¢çš„ç« èŠ‚å·²ç»å‡†å¤‡å¥½äº†ã€‚ 
- âœ…ç¬¬äºŒæ­¥ï¼šè¿è¡Œ RAG æ£€ç´¢ç³»ç»Ÿï¼Œè¾“å…¥é—®é¢˜ï¼Œè¿”å›å‰ k ä¸ªæ£€ç´¢ç»“æœã€‚ 
- âœ…ç¬¬ä¸‰æ­¥ï¼šè¯„ä¼°æ£€ç´¢æ•ˆæœã€‚æ ¹æ®ç³»ç»Ÿè¿”å›çš„æ–‡æ¡£å’ŒçœŸå®ç­”æ¡ˆè¿›è¡ŒæŒ‡æ ‡è®¡ç®—ï¼Œè·å–æ£€ç´¢è¯„ä¼°æŒ‡æ ‡å€¼ã€‚ 

### 4.3.5 æ£€ç´¢è¯„ä¼°æœ€ä½³å®è·µ
| é—®é¢˜ | å»ºè®® |
| --- | --- |
| 2 æ£€ç´¢ä¸åˆ°æ­£ç¡®ä¿¡æ¯ï¼Ÿ | æ£€æŸ¥ embedding æ¨¡å‹æ˜¯å¦åŒ¹é…çŸ¥è¯†åº“è¯­æ–™ï¼ˆè¯•è¯• bgeã€qwen3-embeddingã€bce ç­‰ï¼‰ã€‚ç‰¹åˆ«æ˜¯çŸ¥è¯†å«æœ‰å¤§é‡ç¼©å†™ã€è¡Œä¸šé»‘è¯ã€ä¸“ä¸šæœ¯è¯­ï¼Œå¯¼è‡´ embedding è¯­ä¹‰æ•æ‰æ•ˆæœå·®ï¼Œå»ºè®®å¾®è°ƒåµŒå…¥æ¨¡å‹ã€‚æ¯”å¦‚ï¼ˆHWï¼šåä¸ºã€åŠæ³¢ã€å®¶åº­ä½œä¸šã€æŠ¤ç½‘ç­‰ï¼‰ |
| 3 æ­£ç¡®æ–‡æ¡£æ’å¾—å¤ªåï¼Ÿ | è€ƒè™‘åŠ å…¥ rerankerï¼ˆå¦‚ Cohere Rerankã€bge-rerankerï¼‰ |
| 4 å¤šä¸ªæ–‡æ¡£éƒ½åŒ…å«ç»“æœï¼Ÿ | ç”¨ NDCG æŒ‡æ ‡è€ƒè™‘â€œå¤šä¸ªæ­£ç¡®ç­”æ¡ˆâ€çš„æƒ…å†µ |
| 5 æ£€ç´¢å†…å®¹å¤ªé•¿æˆ–å¤ªçŸ­ï¼Ÿ | åˆç†åˆ‡ç‰‡æ–‡æ¡£ï¼ˆå¦‚æ¯æ®µ 200 - 500 å­—ï¼‰ï¼Œæå‡å¯æ£€ç´¢æ€§ |

æ­¤å¤–ï¼Œå…³äº RAG å‡†ç¡®ç‡å’Œå¬å›ç‡çš„æƒè¡¡ä¹‹æœ¯ï¼ˆTrade-offï¼‰ï¼Œè¿™é‡Œé¢çš„æ°´æ—¢æ·±åˆæ··ï¼Œæˆ‘ä¹Ÿæ‹¿å‡ºæˆ‘å¤šå¹´çš„å¿ƒå¾—ï¼Œä¾›å¤§å®¶æ‰¹è¯„æŒ‡æ­£ã€‚ 

å¬å›ç‡å’Œå‡†ç¡®ç‡é€šå¸¸å­˜åœ¨æ­¤æ¶ˆå½¼é•¿çš„å…³ç³»ï¼š
- ä¸ºäº†æé«˜å¬å›ç‡ï¼Œä¹Ÿå°±æ˜¯å°½å¯èƒ½æ‰¾åˆ°æ›´å¤šç›¸å…³æ–‡æ¡£ï¼Œå¸¸å¸¸éœ€è¦æ”¾å®½æ£€ç´¢æ¡ä»¶ï¼ˆå¦‚é™ä½å‘é‡ç›¸ä¼¼åº¦é˜ˆå€¼ã€æ‰©å¤§æ£€ç´¢çª—å£ç­‰ï¼‰ï¼Œä½†è¿™ä¹ˆåšå¾€å¾€ä¼šå¯¼è‡´æ£€ç´¢å‡ºæ›´å¤šä¸ç›¸å…³æ–‡æ¡£ï¼Œä»è€Œé™ä½å‡†ç¡®ç‡ã€‚ 
- ä¸ºäº†æé«˜å‡†ç¡®ç‡ï¼Œä¹Ÿå°±æ˜¯åªè¿”å›æœ€ç›¸å…³çš„æ–‡æ¡£ï¼Œå¾€å¾€éœ€è¦æ”¶ç´§æ£€ç´¢æ¡ä»¶ï¼ˆå¦‚æé«˜å‘é‡ç›¸ä¼¼åº¦é˜ˆå€¼ã€å‡å°‘è¿”å›æ•°é‡ç­‰ï¼‰ï¼Œä½†è¿™ä¹ˆåšå¾€å¾€ä¼šâ€¦â€¦ï¼ˆå†…å®¹æ˜¾ç¤ºä¸å…¨ ï¼‰ 

ç†æƒ³æƒ…å†µæ˜¯æ—¢è¦åˆè¦ï¼Œä½†åœ¨å®é™…æƒ…å†µå¾ˆéš¾åŒæ—¶è¾¾åˆ°æœ€ä¼˜ï¼Œéœ€è¦æ ¹æ®å…·ä½“ä¸šåŠ¡åœºæ™¯è¿›è¡Œæƒè¡¡ã€‚ 
- æ¯”å¦‚ä½ é¢å¯¹çš„æ˜¯é«˜å®Œæ•´æ€§çš„åœºæ™¯ï¼ˆå¦‚é—®ç­”ã€äº‹å®æ ¸æŸ¥ï¼‰ï¼šå¯èƒ½æ›´å€¾å‘äºä¼˜å…ˆä¿è¯é«˜å¬å›ç‡ï¼Œæ­¤æ—¶å¬å›ç‡å°±æ˜¯åŒ—ææ˜ŸæŒ‡æ ‡ã€‚ç¡®ä¿å…³é”®ä¿¡æ¯ä¸é—æ¼ï¼Œç„¶åä¾èµ– LLM é²æ£’æ€§å»å¤„ç†ä¸€äº›å™ªéŸ³ï¼Œæˆ–é€šè¿‡åç»­ Reranking æå‡å‡†ç¡®ç‡ã€‚


- æ¯”å¦‚ä½ é¢å¯¹çš„æ˜¯é«˜ç²¾åº¦çš„åœºæ™¯ï¼ˆå¦‚æ³•å¾‹ã€é‡‘èã€ä»£ç è¡¥å…¨ï¼‰ï¼šå¯èƒ½æ›´å€¾å‘äºä¼˜å…ˆä¿è¯é«˜å‡†ç¡®ç‡ï¼Œç¡®ä¿æä¾›ç»™ LLM çš„ä¿¡æ¯é«˜åº¦ç›¸å…³ï¼Œé¿å…è¢«æ— å…³ä¿¡æ¯å¸¦åã€‚ 

# å®æ“ä¸­ï¼ŒRAGç³»ç»Ÿæå‡ä¸¤è€…çš„å¸¸è§ç­–ç•¥
### æé«˜å¬å›ç‡æ–¹æ³•
- **ä¼˜åŒ–åˆ†å—ç­–ç•¥ï¼ˆChunkingï¼‰**ï¼šå°è¯•é‡å åˆ†å—ã€æŒ‰è¯­ä¹‰/å¥å­åˆ†å—ã€å¤šç²’åº¦åˆ†å—ç­‰ï¼Œé¿å…å…³é”®ä¿¡æ¯è¢«åˆ‡åˆ†åœ¨è¾¹ç•Œä¸¢å¤±ã€‚ 
- **æ”¹è¿›æ£€ç´¢å™¨ï¼ˆRetrieverï¼‰**ï¼šå°è¯•ä¸åŒçš„åµŒå…¥æ¨¡å‹ï¼ˆEmbedding Modelï¼‰ã€å¾®è°ƒåµŒå…¥æ¨¡å‹ä½¿å…¶æ›´è´´åˆä¸‹æ¸¸ä»»åŠ¡ã€ç»“åˆå…³é”®è¯æ£€ç´¢ï¼ˆå¦‚ BM25ï¼‰ä¸å‘é‡æ£€ç´¢ï¼Œä¹Ÿå°±æ˜¯æ··åˆæ£€ç´¢ï¼ˆHybrid Searchï¼‰ã€‚ 
- **æ‰©å¤§æ£€ç´¢èŒƒå›´**ï¼šé€‚å½“å¢åŠ  `top-k`ï¼ˆè¿”å›æ–‡æ¡£æ•°é‡ï¼‰ï¼Œé™ä½ç›¸ä¼¼åº¦é˜ˆå€¼ã€‚ 
- **æŸ¥è¯¢æ‰©å±•/æ”¹å†™ï¼ˆQuery Expansion/Rewritingï¼‰**ï¼šè®©åŸå§‹æŸ¥è¯¢æ›´ä¸°å¯Œæˆ–æ›´æ¸…æ™°ã€‚ 

### æå‡å‡†ç¡®ç‡
- **é‡æ’åºï¼ˆRerankingï¼‰**ï¼šè¿™æ˜¯æœ€å¸¸ç”¨çš„æœ‰æ•ˆæ‰‹æ®µï¼åˆæ­¥æ£€ç´¢ï¼ˆå¦‚å‘é‡æ£€ç´¢è¿”å› `top-k`ï¼‰åï¼Œä½¿ç”¨ä¸€ä¸ªæ›´å¼ºå¤§ä½†è®¡ç®—æˆæœ¬æ›´é«˜çš„æ¨¡å‹ï¼ˆå¦‚ Cross-Encoderï¼‰å¯¹å€™é€‰æ–‡æ¡£è¿›è¡Œç²¾ç»†ç›¸å…³æ€§æ’åºï¼Œåªä¿ç•™æœ€ç›¸å…³ `top-n` ä¸ªç»™ LLMã€‚ 
- **ä¼˜åŒ–æ£€ç´¢å™¨**ï¼šåŒæ ·å¯ä»¥å°è¯•æ›´å¥½çš„åµŒå…¥æ¨¡å‹æˆ–å¾®è°ƒï¼Œä½¿å…¶åŒºåˆ†ç›¸å…³/ä¸ç›¸å…³æ–‡æ¡£çš„èƒ½åŠ›æ›´å¼ºã€‚ 
- **æ”¶ç´§æ£€ç´¢èŒƒå›´**ï¼šæé«˜ç›¸ä¼¼åº¦é˜ˆå€¼ï¼Œå‡å°‘ `top-k`ã€‚ 
- **å…ƒæ•°æ®è¿‡æ»¤**ï¼šå¦‚æœæ–‡æ¡£æœ‰å¯ç”¨å…ƒæ•°æ®ï¼ˆå¦‚æ¥æºã€æ—¥æœŸã€ç±»å‹ï¼‰ï¼Œåˆ©ç”¨å…¶è¿›è¡Œé¢„è¿‡æ»¤ã€‚ 
- **ä¼˜åŒ–åˆ†å—ç­–ç•¥**ï¼šç¡®ä¿åˆ†å—æœ¬èº«å…·æœ‰è¾ƒå¥½çš„è¯­ä¹‰å®Œæ•´æ€§ï¼Œé¿å…åŒ…å«è¿‡å¤šæ— å…³å†…å®¹ã€‚ 

å½“ç„¶ï¼Œç›¸ä¿¡çœ‹è§†é¢‘çš„æœ‹å‹è—é¾™å§è™ï¼Œå¦‚æœæœ‰æ›´å¤šå®æˆ˜ç»éªŒå’Œè§£å†³æ€è·¯ï¼Œæ¬¢è¿è¯„è®ºåŒºå’Œå¼¹å¹•åŒºç•™ä¸‹è¶³è¿¹ã€‚ 

### ç¬¬äºŒæ®µå†…å®¹ï¼ˆå«è¡¥å……éƒ¨åˆ† ï¼‰
#### æå‡å¬å›ç‡æ–¹æ³•
- **ä¼˜åŒ–åˆ†å—ç­–ç•¥ï¼ˆChunkingï¼‰**ï¼šå°è¯•é‡å åˆ†å—ã€æŒ‰è¯­ä¹‰/å¥å­åˆ†å—ã€å¤šç²’åº¦åˆ†å—ç­‰ï¼Œé¿å…å…³é”®ä¿¡æ¯è¢«åˆ‡åˆ†åœ¨è¾¹ç•Œä¸¢å¤±ã€‚ 
- **æ”¹è¿›æ£€ç´¢å™¨ï¼ˆRetrieverï¼‰**ï¼šå°è¯•ä¸åŒçš„åµŒå…¥æ¨¡å‹ï¼ˆEmbedding Modelï¼‰ã€å¾®è°ƒåµŒå…¥æ¨¡å‹ä½¿å…¶æ›´è´´åˆä¸‹æ¸¸ä»»åŠ¡ã€ç»“åˆå…³é”®è¯æ£€ç´¢ï¼ˆå¦‚ BM25ï¼‰ä¸å‘é‡æ£€ç´¢ï¼Œä¹Ÿå°±æ˜¯æ··åˆæ£€ç´¢ï¼ˆHybrid Searchï¼‰ã€‚ 
- **æ‰©å¤§æ£€ç´¢èŒƒå›´**ï¼šé€‚å½“å¢åŠ  `top-k`ï¼ˆè¿”å›æ–‡æ¡£æ•°é‡ï¼‰ï¼Œé™ä½ç›¸ä¼¼åº¦é˜ˆå€¼ã€‚ 
- **æŸ¥è¯¢æ‰©å±•æ”¹å†™ï¼ˆQuery Expansion/Rewritingï¼‰**ï¼šè®©åŸå§‹æŸ¥è¯¢æ›´ä¸°å¯Œæˆ–æ›´æ¸…æ™°ã€‚ 

#### æå‡å‡†ç¡®ç‡
- **é‡æ’åºï¼ˆRerankingï¼‰**ï¼šè¿™æ˜¯æœ€å¸¸ç”¨çš„æœ‰æ•ˆæ‰‹æ®µï¼åˆæ­¥æ£€ç´¢ï¼ˆå¦‚å‘é‡æ£€ç´¢è¿”å› `top-k`ï¼‰åï¼Œä½¿ç”¨ä¸€ä¸ªæ›´å¼ºå¤§ä½†è®¡ç®—æˆæœ¬æ›´é«˜çš„æ¨¡å‹ï¼ˆå¦‚ Cross-Encoderï¼‰å¯¹å€™é€‰æ–‡æ¡£è¿›è¡Œç²¾ç»†ç›¸å…³æ€§æ’åºï¼Œåªä¿ç•™æœ€ç›¸å…³ `top-n` ä¸ªç»™ LLMã€‚ 
- **ä¼˜åŒ–æ£€ç´¢å™¨**ï¼šåŒæ ·å¯ä»¥å°è¯•æ›´å¥½çš„åµŒå…¥æ¨¡å‹æˆ–å¾®è°ƒï¼Œä½¿å…¶åŒºåˆ†ç›¸å…³/ä¸ç›¸å…³æ–‡æ¡£çš„èƒ½åŠ›æ›´å¼ºã€‚ 
- **æ”¶ç´§æ£€ç´¢èŒƒå›´**ï¼šæé«˜ç›¸ä¼¼åº¦é˜ˆå€¼ï¼Œå‡å°‘ `top-k`ã€‚ 
- **å…ƒæ•°æ®è¿‡æ»¤**ï¼šå¦‚æœæ–‡æ¡£æœ‰å¯ç”¨å…ƒæ•°æ®ï¼ˆå¦‚æ¥æºã€æ—¥æœŸã€ç±»å‹ï¼‰ï¼Œåˆ©ç”¨å…¶è¿›è¡Œé¢„è¿‡æ»¤ã€‚ 
- **ä¼˜åŒ–åˆ†å—ç­–ç•¥**ï¼šç¡®ä¿åˆ†å—æœ¬èº«å…·æœ‰è¾ƒå¥½çš„è¯­ä¹‰å®Œæ•´æ€§ï¼Œé¿å…åŒ…å«è¿‡å¤šæ— å…³å†…å®¹ã€‚ 

å½“ç„¶ï¼Œç›¸ä¿¡çœ‹è§†é¢‘çš„æœ‹å‹è—é¾™å§è™ï¼Œå¦‚æœæœ‰æ›´å¤šå®æˆ˜ç»éªŒå’Œè§£å†³æ€è·¯ï¼Œæ¬¢è¿è¯„è®ºåŒºå’Œå¼¹å¹•åŒºç•™ä¸‹è¶³è¿¹ã€‚ 

### 4.4 ç”Ÿæˆè¯„ä¼°


ä¸Šé¢æˆ‘ä»¬èŠ±äº†å¤§ç¯‡å¹…ä»‹ç»æ£€ç´¢è¯„ä¼°ï¼Œå…¶å®æ€»ç»“ä¸‹æ¥å°±ä¸‹é¢ä¸‰å¥è¯ï¼š


1. æŸ¥å¾—å‡†å—ï¼Ÿï¼ˆPrecisionï¼‰

2. æŸ¥åˆ°äº†å—ï¼Ÿï¼ˆRecall / Hitï¼‰ 

3. æŸ¥è¯¢ç»“æœé å‰å—ï¼Ÿï¼ˆMRRï¼‰ 


æˆ‘ä»¬è¦çŸ¥é“æ£€ç´¢è¯„ä¼°æ˜¯ RAG æˆè´¥çš„å…³é”®ä¸€æ­¥ã€‚å¦‚æœä½ æŸ¥éƒ½æŸ¥ä¸åˆ°ï¼Œåé¢ç”Ÿæˆä¹Ÿæ˜¯â€œå·§å¦‡éš¾ä¸ºæ— ç±³ä¹‹ç‚Šâ€ã€‚ 

#### 4.4.1 ç”Ÿæˆè¯„ä¼°å®šä¹‰ 
å¦‚æœè¯´æ£€ç´¢è¯„ä¼°å…³æ³¨çš„æ˜¯æ£€ç´¢è¿‡ç¨‹ï¼Œé‚£ä¹ˆç”Ÿæˆè¯„ä¼°å…³æ³¨çš„å°±æ˜¯æ‹¿åˆ°æ£€ç´¢çš„æ–‡æ¡£è¿›è¡Œç”Ÿæˆï¼Œç„¶ååˆ¤æ–­ç”Ÿæˆç­”æ¡ˆæ˜¯å¦æ­£ç¡®ã€æœ‰ç”¨å’Œå¿ å®ã€‚ 

#### 4.4.2 ç”Ÿæˆè¯„ä¼°ç›®æ ‡ 
ç”Ÿæˆè¯„ä¼°ç›®æ ‡æ€»ç»“ä¸‹æ¥æœ‰ä»¥ä¸‹å‡ ä¸ªï¼Œåˆ†åˆ«æ˜¯ï¼š
- **å‡†ç¡®æ€§ï¼ˆCorrectnessï¼‰**ï¼šä¹Ÿå°±æ˜¯è¯´ç”Ÿæˆç»“æœå¯¹ä¸å¯¹ï¼Œæœ‰æ²¡æœ‰åŸºäºäº‹å®ï¼Œæœ‰æ²¡æœ‰ç­”åï¼Ÿ 
- **å¿ å®æ€§ï¼ˆFaithfulness / Groundednessï¼‰**ï¼šæœ‰æ²¡æœ‰æŒ‰ç…§çŸ¥è¯†åº“å›ç­”ï¼Ÿæœ‰æ²¡æœ‰èƒ¡ç¼–ä¹±é€ ï¼Ÿ 
- **è¡¨è¾¾å¥½ï¼ˆFluency / Clarityï¼‰**ï¼šè¯­è¨€æ˜¯å¦æµç•…ï¼Œæ˜¯å¦å®¹æ˜“ç†è§£ï¼Ÿ 
- **è¦†ç›–å®Œæ•´ï¼ˆCompletenessï¼‰**ï¼šæœ‰æ²¡æœ‰ç­”å…¨ï¼Ÿæœ‰æ²¡æœ‰é—æ¼å…³é”®ä¿¡æ¯ï¼Ÿ 

### 4.4.3 ç”Ÿæˆè¯„ä¼°ç¤ºä¾‹
ä¸ºäº†åŠ æ·±å¤§å®¶å¯¹ç”Ÿæˆè¯„ä¼°çš„ç†è§£ï¼Œæˆ‘è¿˜æ˜¯æ‹¿ã€Šå–œå‰§ä¹‹ç‹ã€‹ä¸¾ä¾‹ã€‚  

è¿˜æ˜¯å…ˆé—®é—®é¢˜ï¼š  
é—®é¢˜ï¼ˆqueryï¼‰ï¼šâ€œæŸ³é£˜é£˜å¯¹å°¹å¤©ä»‡è¯´â€˜ç©ç©è€Œå·²â€™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿâ€  

æˆ‘ä»¬æœŸå¾…ç†æƒ³çš„ç”Ÿæˆç»“æœåº”è¯¥æ˜¯ï¼š  
â€œè¿™å¥è¯å‡ºç°åœ¨ä¸€å¤œæƒ…ä¹‹åï¼ŒæŸ³é£˜é£˜å¯¹å°¹å¤©ä»‡è¯´ï¼šâ€˜ä½ ä¸ä¼šçœŸçš„ä»¥ä¸ºæˆ‘å–œæ¬¢ä½ å§ï¼Ÿå¤§å®¶éƒ½æ˜¯æˆå¹´äººï¼Œç©ç©è€Œå·²ã€‚â€™å¥¹è¡¨é¢ä¸Šæ˜¾å¾—å†·æ¼ ï¼Œå…¶å®æ˜¯åœ¨æ©é¥°å†…å¿ƒçš„è„†å¼±å’Œæƒ…æ„Ÿé˜²å¾¡ã€‚â€  

å¦‚æœå¤§æ¨¡å‹æœ€ç»ˆèƒ½ç”Ÿæˆè¿™æ ·çš„ç»“æœï¼Œæˆ‘å°±è§‰å¾—éå¸¸å®Œç¾ã€‚å› ä¸ºç­”æ¡ˆå¿ å®å‰§æœ¬ã€è¯­æ°”è‡ªç„¶è€Œä¸”è¿˜æœ‰è§£é‡Šã€‚  

ä½†å¦‚æœæœ€ç»ˆç”Ÿæˆçš„ç»“æœæ˜¯ä¸‹é¢å‡ ä¸ªï¼Œé‚£å°±å¾ˆç³Ÿç³•äº†ã€‚  
- â€œæŸ³é£˜é£˜çœŸå¿ƒå–œæ¬¢å°¹å¤©ä»‡ï¼Œè¿™å¥è¯è¡¨è¾¾äº†çˆ±æ„ã€‚â€ â€”â€” è¿™æ ·çš„ç­”å¤æ˜æ˜¾æœ‰ç‚¹é¬¼ç•œäº†  
- â€œç©ç©è€Œå·²è¿™å¥è¯æ˜¯å°¹å¤©ä»‡å¯¹æŸ³é£˜é£˜è¯´çš„ã€‚â€ â€”â€” è¿™æ ·çš„ç­”å¤æ˜æ˜¾äº‹å®é”™è¯¯  
- â€œå¥¹è¯´â€˜ç©ç©è€Œå·²â€™ï¼Œè¿™æ˜¯ç»å…¸çš„å‘¨æ˜Ÿé©°æç¬‘å°è¯ã€‚â€ â€”â€” è¿™æ ·çš„ç­”å¤æ˜æ˜¾æ˜¯èƒ¡æ‰¯  


### 4.4.4 ç”Ÿæˆè¯„ä¼°å®æˆ˜  
ä»‹ç»å®Œç”Ÿæˆè¯„ä¼°ç†è®ºåï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬è¿›å…¥ç”Ÿæˆè¯„ä¼°å®æˆ˜ã€‚

### ç”Ÿæˆè¯„ä¼°æ–¹æ³•
æˆ‘ä»¬å…ˆè°ˆè°ˆç”Ÿæˆè¯„ä¼°åˆ°åº•éƒ½æœ‰å“ªäº›æ–¹æ³•ã€‚ç”Ÿæˆè¯„ä¼°å¸¸ç”¨ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ï¼š  

#### 1. æœºå™¨è¯„ä¼°æŒ‡æ ‡  
è®¾ç½®æ•°å­¦æŒ‡æ ‡ï¼Œç„¶åæœºå™¨è®¡ç®—ï¼Œè¿™äº›æŒ‡æ ‡åˆ†ä¸ºä¸‰ä¸ªç»´åº¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š  

| æŒ‡æ ‡ | å«ä¹‰ | ç‰¹ç‚¹ |  
| ---- | ---- | ---- |  
| BLEU / ROUGE / METEOR | åŸºäºç»Ÿè®¡æ–¹æ³•ï¼ˆn-gramï¼‰è®¡ç®—ç”Ÿæˆçš„å›ç­”å’Œâ€œå‚è€ƒç­”æ¡ˆâ€æœ‰å¤šå°‘è¯é‡åˆï¼Œä¹Ÿå°±æ˜¯è¯åŒ¹é… | å¿«ï¼Œä½†åå­—é¢ï¼Œä¸å¤Ÿæ™ºèƒ½ |  
| BERTScore | åŸºäºä¸Šä¸‹æ–‡ Embedding çœ‹è¯­ä¹‰ç›¸ä¼¼åº¦ï¼Œéè¯åŒ¹é… | æ›´å‡†ç¡®ï¼Œå¸¸ç”¨ |  
| QA-based eval | ä½¿ç”¨å¦ä¸€ä¸ªè®­ç»ƒå¥½çš„é—®ç­”ï¼ˆQAï¼‰æ¨¡å‹ï¼ˆé€šå¸¸ç§°ä¸ºâ€œè¯„åˆ¤æ¨¡å‹â€æˆ–â€œè¯„ä¼°å™¨æ¨¡å‹â€ï¼‰æ¥è‡ªåŠ¨è¯„ä¼°ç”Ÿæˆç»“æœ | é€‚åˆé—®ç­”ç³»ç»Ÿ |  

è¿™ç§è¯„ä¼°æ–¹æ³•ç±»ä¼¼æ£€ç´¢è¯„ä¼°æŒ‡æ ‡ï¼Œæœ¬è´¨æ˜¯ä¾é ç»Ÿè®¡å­¦ã€å‘é‡è®¡ç®—ç­‰æ•°å­¦æ–¹æ³•è®¡ç®—ç”Ÿæˆå†…å®¹å’ŒæœŸæœ›å†…å®¹çš„åŒ¹é…åº¦æˆ–ç›¸ä¼¼åº¦ã€‚è¯¥æ–¹æ³•å¯ä»¥é€‚åˆå¤§è§„æ¨¡å¿«é€Ÿè¯„ä¼°ï¼Œä½†ç¼ºç‚¹ä¹Ÿæ˜¾è€Œæ˜“è§ï¼Œæ— æ³•åˆ¤æ–­â€œæ˜¯å¦èƒ¡ç¼–â€ï¼Œä¹Ÿéå¸¸ä¾èµ–å‚è€ƒç­”æ¡ˆçš„è´¨é‡ã€‚  


#### 2. ç”¨å¤§è¯­è¨€æ¨¡å‹åšè¯„å®¡ï¼ˆLLM-as-a-Judgeï¼‰  
å¯ä»¥é€šè¿‡ GPT-4ã€Claude ç­‰å¤§æ¨¡å‹å¯¹ç”Ÿæˆç»“æœæ‰“åˆ†ï¼Œåªéœ€è®¾è®¡å¥½æç¤ºè¯å³å¯ï¼Œæ¯”å¦‚ï¼š  

**ä»£ç å—**  
```
Prompt:
ä½ æ˜¯ä¸€ä¸ªè¯„ä¼°ä¸“å®¶ï¼Œè¯·åˆ¤æ–­ä¸‹é¢çš„å›ç­”å†…å®¹æ˜¯å¦å¿ äºæä¾›çš„å‚è€ƒèµ„æ–™ï¼Œæ˜¯å¦å®Œæ•´ã€å‡†ç¡®ã€‚  
å‚è€ƒèµ„æ–™ï¼šâ€¦â€¦  
å›ç­”å†…å®¹ï¼šâ€¦â€¦  
è¯·ä»å‡†ç¡®æ€§ã€å¿ å®æ€§ã€è¡¨è¿°æ¸…æ™°åº¦ä¸‰æ–¹é¢åˆ†åˆ«è¯„åˆ†ã€‚  
```  

è¯¥æ–¹æ³•ä¼˜ç‚¹æ˜¯æ–¹ä¾¿ã€ç»æµã€æ™ºèƒ½ã€ç†è§£è¯­ä¹‰ã€‚ç¼ºç‚¹åœ¨äºè¯„å®¡ç»“æœä¸ç¨³å®šæˆ–ä¸ä¸€è‡´ï¼ˆå½“ç„¶ä¹Ÿæœ‰è§£å†³æ–¹æ¡ˆï¼Œæ¯”å¦‚ï¼šè®©å¤šä¸ªæ¨¡å‹è¯„å®¡ï¼Œç„¶åå–å¹³å‡å€¼ï¼‰ã€‚  


#### 3. äººå·¥è¯„ä¼°  
æœ€åä¸€ç§æ–¹å¼å°±æ˜¯äººå·¥è¯„ä¼°äº†ï¼Œè¿™æ˜¯æˆæœ¬æœ€é«˜çš„æ–¹å¼ã€‚è™½ç„¶æœ€è´µï¼Œä½†ä¹Ÿæ˜¯æœ€æƒå¨çš„ã€‚æ“ä½œæ–¹å¼å¦‚ä¸‹ï¼š  

| ç»´åº¦ | æ‰“åˆ†æ–¹å¼ç¤ºä¾‹ |  
| ---- | ---- |  
| æ­£ç¡®æ€§ | å›ç­”æ˜¯å¦å’ŒçœŸå®æƒ…å†µä¸€è‡´ï¼Ÿï¼ˆ1-5åˆ†ï¼‰ |  
| å¿ å®æ€§ | å›ç­”æ˜¯å¦ä»æ£€ç´¢å†…å®¹ä¸­æ¨å¯¼å‡ºï¼Ÿï¼ˆ1-5åˆ†ï¼‰ |  
| è¡¨è¾¾æ€§ | æœ‰æ²¡æœ‰è¯­ç—…ï¼Ÿè¯»èµ·æ¥é¡ºä¸é¡ºï¼Ÿï¼ˆ1-5åˆ†ï¼‰ |  
| å®Œæ•´æ€§ | æ˜¯å¦æ¼ç­”ã€ç®€ç•¥ã€åé¢˜ï¼Ÿï¼ˆ1-5åˆ†ï¼‰ |  

ä½†äººå·¥è¯„ä¼°æ–¹å¼ï¼Œâ€¦â€¦ï¼ˆå†…å®¹æ˜¾ç¤ºä¸å…¨ ï¼‰  

ç»“åˆä¸Šé¢ä¸‰ç§ç”Ÿæˆè¯„ä¼°æ–¹æ³•ï¼Œå®é™…ç»å¸¸é‡‡ç”¨çš„ç­–ç•¥æ˜¯æ‰“ç»„åˆæ‹³ï¼Œå³ï¼š  
- å°æ•°æ®é›†é‡‡ç”¨äººå·¥è¯„ä¼°ï¼›  
- å¤§æ•°æ®é›†å…ˆç”¨æ¨¡å‹ä»£è¯„ï¼Œç„¶åå†æŠ½æ ·äººå·¥å¤æŸ¥ã€‚  


### 4.4.4.2 ç”Ÿæˆè¯„ä¼°æµç¨‹  
ä»‹ç»å®Œç”Ÿæˆè¯„ä¼°çš„æ–¹æ³•åï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬æ€»ç»“ä¸‹å®æ–½æµç¨‹ï¼š  
- âœ…ç¬¬ä¸€æ­¥ï¼šè¿˜æ˜¯æ„å»ºé»„é‡‘æ•°æ®é›†ã€‚  
- âœ…ç¬¬äºŒæ­¥ï¼šè·‘ä¸€è½® RAGï¼Œæ‹¿åˆ°ç”Ÿæˆç»“æœã€‚  
- âœ…ç¬¬ä¸‰æ­¥ï¼šç”¨ä»¥ä¸‹æ–¹æ³•è¯„ä¼°ç”Ÿæˆç­”æ¡ˆï¼š  
  - è¯­ä¹‰ç›¸ä¼¼åº¦ï¼ˆBERTScoreï¼‰  
  - å¿ å®æ€§åˆ¤æ–­ï¼ˆç”¨ GPT-4ã€Geminiã€Grokã€Claude åš Groundedness è¯„åˆ†ï¼‰  
  - äººå·¥æŠ½æ ·æŸ¥çœ‹  
- âœ…ç¬¬å››æ­¥ï¼šæ ¹æ®è¯„ä¼°ç»“æœè®°å½•é”™è¯¯ç±»å‹ï¼š  
  - æ˜¯å¦èƒ¡è¯´å…«é“ï¼ˆå¹»è§‰ï¼‰  
  - æ˜¯å¦æ¼ç­”  
  - æ˜¯å¦ç­”éæ‰€é—®  
  - æ˜¯å¦é€»è¾‘æ··ä¹±  


### 4.4.4.3 ç”Ÿæˆè¯„ä¼°æœ€ä½³å®è·µ  
æœ‰å…³ç”Ÿæˆè¯„ä¼°æœ€ä½³å®è·µï¼Œæˆ‘ä¹Ÿåˆ—äº†ä¸€å¼ è¡¨ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚

### 4.4.4.3 ç”Ÿæˆè¯„ä¼°æœ€ä½³å®è·µ
æœ‰å…³ç”Ÿæˆè¯„ä¼°æœ€ä½³å®è·µï¼Œæˆ‘ä¹Ÿåˆ—äº†ä¸€å¼ è¡¨ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
| ---- | ---- | ---- |
| ç¼–é€ ä¿¡æ¯ | æ£€ç´¢å†…å®¹æ²¡è¦†ç›–åˆ°ï¼Œæˆ–æ¨¡å‹å¤ªè‡ªç”± | é™åˆ¶ Promptï¼šåªå…è®¸åŸºäºæ–‡æ¡£å›ç­” |
| å›ç­”å¤ªçŸ­ | Prompt ä¸å®Œæ•´ | æ˜ç¡®è¦æ±‚â€œè§£é‡ŠåŸå› +å¼•ç”¨åŸæ–‡â€ |
| å¹»è§‰ | æ£€ç´¢+Prompt åŒé—®é¢˜ | ä¼˜åŒ–é—®é¢˜åŒ¹é…å¹¶è¿›è¡Œé—®é¢˜æŒ‡å¼• |  

ä»ä¸Šé¢å†…å®¹ä»¥åŠæ¨¡å‹åŸç†å…¶å®å¯ä»¥å¾—å‡ºç»“è®ºï¼Œå¦‚æœæƒ³æå‡ç”Ÿæˆæ•ˆæœï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºæŠŠæç¤ºè¯å†™å¥½ã€‚  


### 4.5 ç«¯åˆ°ç«¯è¯„ä¼°ï¼ˆE2E Evaluationï¼‰  
æ£€ç´¢è¯„ä¼°å’Œç”Ÿæˆè¯„ä¼°ä»‹ç»å®Œæ¯•åï¼Œæˆ‘ä»¬å†ä»‹ç»ä¸‹ç«¯åˆ°ç«¯è¯„ä¼°ã€‚  


#### 4.5.1 ç«¯åˆ°ç«¯è¯„ä¼°å®šä¹‰  
æˆ‘ä»¬éƒ½æ¸…æ¥šï¼Œåœ¨ RAG ç³»ç»Ÿä¸­ï¼š  
- æ£€ç´¢å™¨ï¼ˆRetrieverï¼‰ï¼šç”¨æ¥æ£€ç´¢ç›¸å…³æ–‡æ¡£  
- ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰ï¼šåŸºäºæ£€ç´¢çš„æ–‡æ¡£ç”Ÿæˆå›ç­”  
- æœ€ç»ˆè¾“å‡ºï¼šæ˜¯å‘ˆç°ç»™ç”¨æˆ·çš„å›ç­”  

æ‰€ä»¥ï¼Œç«¯åˆ°ç«¯è¯„ä¼°ï¼ˆEnd-to-End Evaluationï¼‰å°±æ˜¯ä»ç”¨æˆ·è§†è§’æ•´ä½“è¯„ä¼°æ•´ä¸ªæµç¨‹è¡¨ç°ã€‚ä¹Ÿå°±æ˜¯è¯´ä½œä¸ºæœ€ç»ˆç”¨æˆ·è§†è§’ï¼Œä»–æ ¹æœ¬å°±ä¸å…³å¿ƒï¼š  
- ç¬¬ä¸€å±‚ï¼Œæœ‰æ²¡æœ‰æŸ¥å‡†  
- ç¬¬äºŒå±‚ï¼Œæœ‰æ²¡æœ‰ç­”å¯¹  

è€Œå®ƒåªå…³å¿ƒï¼š  
â€œå…³äºæˆ‘æå‡ºçš„é—®é¢˜ï¼Œä½ ç»™æˆ‘çš„å›ç­”å¤Ÿä¸å¤Ÿå¥½ï¼Ÿâ€  

ä»¥åŠæ ¹æ®æœ€ç»ˆç»“æœï¼Œä»–çš„æ€åº¦ï¼Œé‚£ä¾¿æ˜¯ï¼š  
è¿™ç³»ç»Ÿå€¼ä¸å€¼å¾—æˆ‘ä¹°å•  


#### 4.5.2 ç«¯åˆ°ç«¯è¯„ä¼°ç›®æ ‡  
ä¸Šé¢æˆ‘å·²ç»éå¸¸è¯¦ç»†ä»‹ç»è¿‡ç”Ÿæˆè¯„ä¼°ï¼Œè¿™ä¸ºä»‹ç»ç«¯åˆ°ç«¯è¯„ä¼°æ‰“ä¸‹éå¸¸å¥½çš„åŸºç¡€ï¼Œä¸‹é¢æˆ‘åˆ—äº†ä¸€å¼ è¡¨ï¼š  

| ç»´åº¦ | è§£é‡Š | ä¸¾ä¾‹é—®é¢˜ |  
| ---- | ---- | ---- |  
| âœ…æ­£ç¡®æ€§ï¼ˆCorrectnessï¼‰ | å›ç­”æ˜¯å¦å®¢è§‚çœŸå®ï¼Ÿæœ‰æ²¡æœ‰äº‹å®é”™è¯¯ï¼Ÿ | ä½ æ˜¯ä¸æ˜¯åœ¨èƒ¡ç¼–ä¹±é€ ï¼Ÿ |  
| âœ…å¿ å®æ€§ï¼ˆFaithfulnessï¼‰ | å›ç­”æ˜¯å¦çœŸçš„åŸºäºä½ æ£€ç´¢åˆ°çš„å†…å®¹ï¼Ÿ | ä½ æ˜¯ä¸æ˜¯è„±ç¦»ææ–™è‡ªç”±å‘æŒ¥äº†ï¼Ÿ |  
| âœ…æœ‰ç”¨æ€§ï¼ˆHelpfulnessï¼‰ | å›ç­”æ˜¯å¦å¯¹ç”¨æˆ·æœ‰ä»·å€¼ï¼Ÿ | è¿™å›ç­”å¯¹æˆ‘æœ‰æ²¡æœ‰ç”¨ï¼Ÿ |  
| âœ…å®Œæ•´æ€§ï¼ˆCompletenessï¼‰ | æœ‰æ²¡æœ‰æ¼ç­”å…³é”®ç‚¹ï¼Ÿ | è¯´å…¨äº†å—ï¼Ÿæœ‰æ²¡æœ‰è·³è¿‡é‡è¦ä¿¡æ¯ï¼Ÿ |  
| âœ…å¯è¯»æ€§ï¼ˆFluency / Clarityï¼‰ | å›ç­”æµä¸æµç•…ï¼Œå¥½ä¸å¥½è¯»ï¼Ÿ | åƒä¸åƒä¸€ä¸ªæ­£å¸¸äººå†™çš„ï¼Ÿ |  

ä»åˆ—è¡¨çœ‹ï¼Œå…¶å®ç«¯åˆ°ç«¯çš„è¯„ä¼°ç›®æ ‡è·Ÿç”Ÿæˆè¯„ä¼°çš„ç›®æ ‡éå¸¸ç±»ä¼¼ã€‚  

ä½†å¿…é¡»æ˜ç¡®çš„ä¸€ç‚¹æ˜¯ï¼ŒE2E æ˜¯æœ€é«˜è§†è§’ï¼Œæ›´è´´è¿‘â€œç”¨æˆ·ä½“éªŒâ€å’Œâ€œäº§å“ä»·å€¼â€ã€‚  

è€Œä¸” E2E ä¼šä¸»è§‚ï¼Œå› ä¸ºä¸»è§‚ï¼Œæ‰€ä»¥åœ¨è·Ÿå®¢æˆ·äº¤æµçš„è¿‡ç¨‹ä¸­ï¼Œæ›´å¤šéœ€è¦æ²Ÿé€šæŠ€å·§ï¼Œåšå¥½æƒ…ç»ªä»·å€¼ã€‚  

è¿™æ˜¯ä½ è·ç¦»æˆåŠŸçš„æœ€åä¸€å…¬é‡Œï¼Œä½†è¿™ä¸€æ­¥å´å¼‚å¸¸éš¾èµ°ã€‚  


#### 4.5.3 ç«¯åˆ°ç«¯è¯„ä¼°ç¤ºä¾‹  
ä¸ºäº†åŠ æ·±å¤§å®¶å¯¹ç«¯åˆ°ç«¯è¯„ä¼°çš„ç†è§£ï¼Œç»§ç»­æ‹¿ã€Šå–œå‰§ä¹‹ç‹ã€‹åšç¤ºä¾‹ã€‚  

è¿˜æ˜¯å…ˆé—®é—®é¢˜ï¼š  
â€œæŸ³é£˜é£˜è¯´â€˜ç©ç©è€Œå·²â€™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿâ€  

RAG ç³»ç»Ÿç”Ÿæˆå›ç­”ï¼š

### 4.5.4.1 ç«¯åˆ°ç«¯è¯„ä¼°æ–¹æ³•
å¸¸ç”¨ç«¯åˆ°ç«¯è¯„ä¼°æ–¹æ³•ï¼Œä¸€èˆ¬ä¹Ÿæœ‰ä¸‰ç§æ–¹å¼ï¼š  

#### 1. äººå·¥æ‰“åˆ†  
é€‚åˆè¯¥æ–¹å¼çš„åœºæ™¯æ˜¯é«˜è´¨é‡ã€å°æ‰¹é‡çš„æ•°æ®é›†ï¼Œäººå·¥å¯ä»¥æ ¹æ®é»„é‡‘æ•°æ®æ ·æœ¬ç»™å‡ºåˆ†æ•°æˆ–è¯„è¯­  

| è¯„åˆ†ç»´åº¦ | æ‰“åˆ†æ ‡å‡†ï¼ˆ1-5ï¼‰ | ç¤ºä¾‹ |
| ---- | ---- | ---- |
| æ­£ç¡®æ€§ | 5 = å®Œå…¨æ­£ç¡®ï¼Œ1 = å®Œå…¨é”™è¯¯ | â€œäº‹å®æ­£ç¡®æ€§æ˜¯å¦å¯ä¿¡ï¼Ÿâ€ |
| å¿ å®æ€§ | 5 = å®Œå…¨åŸºäºèµ„æ–™ï¼Œ1 = æ˜æ˜¾å¹»è§‰ | â€œå›ç­”æ˜¯å¦å¼•ç”¨æ–‡æ¡£è€Œä¸æ˜¯ç¼–é€ ï¼Ÿâ€ |
| æœ‰ç”¨æ€§ | 5 = éå¸¸æœ‰å¸®åŠ©ï¼Œ1 = æ²¡æœ‰å¸®åŠ© | â€œå¯¹ç”¨æˆ·æœ‰æ²¡æœ‰å®é™…ä»·å€¼ï¼Ÿâ€ |
| å®Œæ•´æ€§ | 5 = ç­”å…¨è¦ç‚¹ï¼Œ1 = ç¼ºå¤±å…³é”®ä¿¡æ¯ | â€œæœ‰æ²¡æœ‰é—æ¼é—®é¢˜ä¸­å…³æ³¨çš„æ–¹é¢ï¼Ÿâ€ |
| å¯è¯»æ€§ | 5 = é€šé¡ºæµç•…ï¼Œ1 = æ··ä¹±ä¸é€š | â€œæ˜¯å¦åƒæ­£å¸¸è‡ªç„¶è¯­è¨€è¡¨è¾¾ï¼Ÿâ€ |  

æŠ€æœ¯æ‰‹æ®µæˆ‘ä»¬å¯ä»¥é€šè¿‡ Excelã€é—®å·ã€Notion ç­‰æ–¹å¼ç»„ç»‡ä¸šåŠ¡ä¸“å®¶æˆ–æ‰“æ ‡äººå‘˜è¿›è¡Œè¯„åˆ†ã€‚  

äººå·¥ç«¯åˆ°ç«¯è¯„ä¼°çš„å¥½å¤„æ˜¯ç²¾å‡†ï¼Œç¼ºç‚¹å°±æ˜¯æˆæœ¬é«˜ã€‚  


#### 2. å¤§è¯­è¨€æ¨¡å‹è¯„åˆ†ï¼ˆLLM-as-a-Judgeï¼‰  
ç±»ä¼¼äºç”Ÿæˆè¯„ä¼°çš„æ–¹å¼ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨ GPT-4 / Claude ç­‰æ¨¡å‹å¸®ä½ è¯„ä¼°å›ç­”æ•ˆæœï¼Œå‰ææ˜¯ä½¿ç”¨å¥½æç¤ºè¯ï¼Œæ¯”å¦‚ä¸‹é¢æˆ‘ç»™çš„æç¤ºè¯æ ·ä¾‹ï¼š  

**ä»£ç å—**  
```
ä½ æ˜¯ä¸€ä¸ªé—®ç­”ç³»ç»Ÿè¯„ä¼°ä¸“å®¶ã€‚è¯·ä»ä»¥ä¸‹äº”ä¸ªç»´åº¦å¯¹å›ç­”è¿›è¡Œ 1-5 åˆ†æ‰“åˆ†ï¼š
1. æ­£ç¡®æ€§
2. å¿ å®æ€§ï¼ˆæ˜¯å¦åŸºäºæä¾›èµ„æ–™ï¼‰
3. æœ‰ç”¨æ€§
4. å®Œæ•´æ€§
5. å¯è¯»æ€§

é—®é¢˜ï¼š
å›ç­”ï¼š
å¯å‚è€ƒæ–‡æ¡£ï¼š
```  

å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡å·¥å…·ï¼Œæ¯”å¦‚ï¼š  
- **Ragas**ï¼šå†…ç½®ç«¯åˆ°ç«¯è¯„ä¼°æ¨¡å—ï¼Œæ”¯æŒ correctness + groundedness + helpfulness  

åŸºäº LLM çš„ç«¯åˆ°ç«¯çš„è¯„ä¼°ä¼˜ç‚¹æ˜¯å¿«ã€å¯æ‰©å±•ï¼Œç¼ºç‚¹æ˜¯ä¸ç¨³å®šï¼Œéœ€æŠ½æ ·æ ¡éªŒã€‚  


#### 3. ç”¨æˆ·åé¦ˆè¯„åˆ†ï¼ˆçº¿ä¸Šç³»ç»Ÿï¼‰  
æœ€åä¸€ç§ç«¯åˆ°ç«¯è¯„ä¼°æ–¹å¼å°±æ˜¯ç³»ç»Ÿä¸Šçº¿åï¼Œé€šè¿‡æ”¶é›†ç”¨æˆ·ã€ŒğŸ‘/ğŸ‘ã€ã€‚è¿™ç§æ–¹å¼æ˜¯æœ€è‡ªç„¶çš„ E2E è¯„ä¼°ã€‚  

è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯å®ç”¨ä»·å€¼æœ€é«˜ï¼Œä½†ç¼ºç‚¹åœ¨äºä¸ç³»ç»Ÿã€åä¸»è§‚ã€æ ·æœ¬å°‘æ—¶ä¸ç¨³å®šã€‚  


### 4.5.4.2 ç«¯åˆ°ç«¯è¯„ä¼°æœ€ä½³å®è·µ  
å…³äºç«¯åˆ°ç«¯è¯„ä¼°æœ€ä½³å®è·µï¼Œä¸‹é¢æˆ‘ä¹Ÿåˆ—äº†ä¸€å¼ è¡¨ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚  

| é—®é¢˜ç±»å‹ | è§£å†³æ–¹å¼ |
| ---- | ---- |
| æ²¡æœ‰å‘½ä¸­æ”¯æŒå†…å®¹ | æå‡æ£€ç´¢ Recallï¼ŒåŠ å…¥ reranker |
| èƒ¡è¯´å…«é“ / ç¼–æ•…äº‹ | Prompt é™åˆ¶åªåŸºäºæ–‡æ¡£ç”Ÿæˆ |
| å›ç­”ä¸å®Œæ•´ | Prompt å¼•å¯¼â€œé€ç‚¹å±•å¼€â€ |
| è¯­è¨€æ€ªå¼‚ / é£æ ¼ä¸è‡ªç„¶ | æ¨¡å‹ fine-tune æˆ– prompt ç²¾è°ƒ |  

ç«¯åˆ°ç«¯è¯„ä¼°è·Ÿç”Ÿæˆè¯„ä¼°å¾ˆå¤šæ—¶å€™å¯ä»¥åˆå¹¶åšï¼ŒåŒºåˆ«åœ¨äºç«¯åˆ°ç«¯è¯„ä¼°å¯å°†çœŸå®çº¿ä¸Šè¯„ä¼°ç»“æœåšæ•°æ®å›æµã€‚

# ragè¯„ä¼°ä½“ç³»æ„å»º

```python
# RAG è¯„ä¼°å…¨æµç¨‹ä»£ç å®æˆ˜ï¼ˆåŸºäºã€Šå–œå‰§ä¹‹ç‹ã€‹ç¤ºä¾‹ï¼‰
from typing import List, Dict
from sklearn.metrics.pairwise import cosine_similarity
from sentence_transformers import SentenceTransformer
import numpy as np
from difflib import SequenceMatcher

# --- ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡æ•°æ®é›† ---
# ç¤ºä¾‹é»„é‡‘æ•°æ®é›†ï¼ˆé—®é¢˜+ç­”æ¡ˆ+æ”¯æŒæ–‡æ¡£ï¼‰
golden_data = [
    {
        "question": "ã€Šå–œå‰§ä¹‹ç‹ã€‹ä¸­æŸ³é£˜é£˜ä¸€å¤œæƒ…åå¯¹å°¹å¤©ä»‡è¯´äº†ä»€ä¹ˆï¼Ÿ",
        "answer": "åœ¨ç”µå½±ã€Šå–œå‰§ä¹‹ç‹ã€‹ä¸­ï¼Œä¸€å¤œæƒ…ä¹‹åï¼ŒæŸ³é£˜é£˜å¯¹å°¹å¤©ä»‡è¯´ï¼šâ€œä½ ä¸ä¼šçœŸçš„ä»¥ä¸ºæˆ‘å–œæ¬¢ä½ å§ï¼Ÿå¤§å®¶éƒ½æ˜¯æˆå¹´äººï¼Œç©ç©è€Œå·²ã€‚â€",
        "supporting_docs": [
            "ç¬¬äºŒå¤©æ¸…æ™¨ï¼ŒæŸ³é£˜é£˜çœ‹ç€å°¹å¤©ä»‡è¯´ï¼šâ€˜ä½ ä¸ä¼šçœŸçš„ä»¥ä¸ºæˆ‘å–œæ¬¢ä½ å§ï¼Ÿå¤§å®¶éƒ½æ˜¯æˆå¹´äººï¼Œç©ç©è€Œå·²ã€‚â€™",
            "å¥¹åˆ»æ„ç”¨è½»æ¾çš„è¯­æ°”æ©é¥°è‡ªå·±çš„å¤æ‚æƒ…ç»ªï¼Œè¯•å›¾æ‹‰å¼€è·ç¦»ã€‚"
        ]
    }
]

# --- ç¬¬äºŒæ­¥ï¼šæ£€ç´¢æ¨¡æ‹Ÿï¼ˆç®€å•è¯­ä¹‰åŒ¹é…ï¼‰ ---
# åˆå§‹åŒ–å‘é‡æ¨¡å‹
encoder = SentenceTransformer('all-MiniLM-L6-v2')

# æ¨¡æ‹ŸçŸ¥è¯†åº“ï¼ˆå‡è®¾å·²è¢«åˆ‡åˆ†æˆæ–‡æ¡£ç‰‡æ®µï¼Œè¿™é‡Œç›´æ¥ç”¨ golden_data é‡Œçš„ supporting_docs æ„é€ æ¼”ç¤º ï¼‰
document_store = [
    "æŸ³é£˜é£˜ç¬¬ä¸€æ¬¡è§å°¹å¤©ä»‡æ˜¯åœ¨é…’å§çš„åå°ã€‚",
    "ç¬¬äºŒå¤©æ¸…æ™¨ï¼ŒæŸ³é£˜é£˜çœ‹ç€å°¹å¤©ä»‡è¯´ï¼šâ€˜ä½ ä¸ä¼šçœŸçš„ä»¥ä¸ºæˆ‘å–œæ¬¢ä½ å§ï¼Ÿå¤§å®¶éƒ½æ˜¯æˆå¹´äººï¼Œç©ç©è€Œå·²ã€‚â€™",
    "å°¹å¤©ä»‡æ¢¦æƒ³æˆä¸ºæ¼”å‘˜ï¼ŒåšæŒæ¯å¤©æ’ç»ƒå°è¯ã€‚",
    "å¥¹åˆ»æ„ç”¨è½»æ¾çš„è¯­æ°”æ©é¥°è‡ªå·±çš„å¤æ‚æƒ…ç»ªï¼Œè¯•å›¾æ‹‰å¼€è·ç¦»ã€‚"
]

def retrieve(question: str, top_k=3) -> List[str]:
    """
    æ¨¡æ‹Ÿæ£€ç´¢è¿‡ç¨‹ï¼š
    1. å¯¹é—®é¢˜å’Œæ–‡æ¡£åº“å†…å®¹åˆ†åˆ«ç¼–ç 
    2. è®¡ç®—è¯­ä¹‰ç›¸ä¼¼åº¦
    3. è¿”å›ç›¸ä¼¼åº¦æœ€é«˜çš„ top_k ä¸ªæ–‡æ¡£ç‰‡æ®µ
    """
    q_emb = encoder.encode([question])
    doc_embs = encoder.encode(document_store)
    scores = cosine_similarity(q_emb, doc_embs)[0]
    # å–ç›¸ä¼¼åº¦é«˜çš„ top_k ä¸ªæ–‡æ¡£ç´¢å¼•ï¼ˆé™åºæ’åˆ—åå–å‰ top_kï¼‰
    top_indices = scores.argsort()[::-1][:top_k]
    return [document_store[i] for i in top_indices]

# --- ç¬¬ä¸‰æ­¥ï¼šç”Ÿæˆæ¨¡æ‹Ÿï¼ˆç®€å•æ‹¼æ¥ï¼Œå®é™…åœºæ™¯å¯æ›¿æ¢ä¸º LLM è°ƒç”¨ ï¼‰ ---
def generate_answer(retrieved_docs: List[str]) -> str:
    """
    æ¨¡æ‹Ÿç”Ÿæˆè¿‡ç¨‹ï¼šç›´æ¥æ‹¼æ¥æ£€ç´¢åˆ°çš„æ–‡æ¡£ç‰‡æ®µä½œä¸ºå›ç­”
    ï¼ˆå®é™…é¡¹ç›®ä¸­ï¼Œè¿™é‡Œä¼šè°ƒç”¨å¤§è¯­è¨€æ¨¡å‹åŸºäºæ–‡æ¡£ç”Ÿæˆæ›´è‡ªç„¶çš„å›ç­”ï¼‰
    """
    return "åŸºäºèµ„æ–™å›ç­”ï¼š" + " | ".join(retrieved_docs)

# --- ç¬¬å››æ­¥ï¼šè¯„ä¼° ---
def evaluate_retrieval(gt_docs: List[str], retrieved_docs: List[str]) -> float:
    """
    è¯„ä¼°æ£€ç´¢æ•ˆæœï¼šåˆ¤æ–­æ£€ç´¢åˆ°çš„æ–‡æ¡£ä¸çœŸå®æ”¯æŒæ–‡æ¡£æ˜¯å¦åŒ¹é…ï¼ˆç›¸ä¼¼åº¦ > 0.8 è§†ä¸ºå‘½ä¸­ï¼‰
    è¿”å›æ˜¯å¦å‘½ä¸­ï¼ˆ1 è¡¨ç¤ºå‘½ä¸­ï¼Œ0 è¡¨ç¤ºæœªå‘½ä¸­ ï¼‰
    """
    for gt in gt_docs:
        for r in retrieved_docs:
            if SequenceMatcher(None, gt, r).ratio() > 0.8:
                return 1.0  # Hit@k
    return 0.0

def evaluate_generation(golden: str, generated: str) -> float:
    """
    è¯„ä¼°ç”Ÿæˆæ•ˆæœï¼šç®€å•è®¡ç®—ç”Ÿæˆå›ç­”ä¸çœŸå®ç­”æ¡ˆçš„æ–‡æœ¬ç›¸ä¼¼åº¦
    ï¼ˆå®é™…å¯ç»“åˆæ›´å¤šç»´åº¦ï¼Œå¦‚å¿ å®æ€§ã€å¯è¯»æ€§ç­‰ ï¼‰
    """
    return SequenceMatcher(None, golden, generated).ratio()

# --- ç¬¬äº”æ­¥ï¼šè¿è¡Œå®Œæ•´æµç¨‹ ---
if __name__ == "__main__":
    for sample in golden_data:
        question = sample["question"]
        gt_answer = sample["answer"]
        gt_docs = sample["supporting_docs"]
        
        print("\n=== é—®é¢˜ ===")
        print(question)
        
        # æ‰§è¡Œæ£€ç´¢
        retrieved = retrieve(question)
        print("\næ£€ç´¢ç»“æœï¼š")
        for d in retrieved:
            print("-", d)
        
        # è¯„ä¼°æ£€ç´¢
        hit_score = evaluate_retrieval(gt_docs, retrieved)
        print(f"\næ£€ç´¢ Hit@k: {hit_score}")
        
        # æ‰§è¡Œç”Ÿæˆ
        gen_answer = generate_answer(retrieved)
        print("\nç”Ÿæˆç­”æ¡ˆï¼š")
        print(gen_answer)
        
        # è¯„ä¼°ç”Ÿæˆ
        gen_score = evaluate_generation(gt_answer, gen_answer)
        print(f"\nç”Ÿæˆç›¸ä¼¼åº¦å¾—åˆ†ï¼š{round(gen_score, 3)}")
```

### ä»£ç è¯´æ˜
1. **æ•°æ®å‡†å¤‡**ï¼šå®šä¹‰äº† `golden_data`ï¼ŒåŒ…å«é—®é¢˜ã€çœŸå®ç­”æ¡ˆã€æ”¯æŒæ–‡æ¡£ï¼Œç”¨äºæ¨¡æ‹Ÿå®é™…ä¸šåŠ¡ä¸­çš„â€œé»„é‡‘æ•°æ®é›†â€ã€‚  
2. **æ£€ç´¢æ¨¡æ‹Ÿ**ï¼šç”¨ `SentenceTransformer` åšæ–‡æœ¬ç¼–ç ï¼Œé€šè¿‡ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—å®ç°ç®€å•è¯­ä¹‰æ£€ç´¢ï¼Œæ¨¡æ‹Ÿ RAG ä¸­çš„æ£€ç´¢å™¨ï¼ˆRetrieverï¼‰ã€‚  
3. **ç”Ÿæˆæ¨¡æ‹Ÿ**ï¼š`generate_answer` ç›´æ¥æ‹¼æ¥æ£€ç´¢ç»“æœæ¼”ç¤ºç”Ÿæˆè¿‡ç¨‹ï¼Œå®é™…é¡¹ç›®éœ€æ›¿æ¢ä¸ºè°ƒç”¨å¤§è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ GPTã€LLaMA ç­‰ï¼‰ç”Ÿæˆè‡ªç„¶å›ç­”ã€‚  
4. **è¯„ä¼°é€»è¾‘**ï¼š  
   - `evaluate_retrieval`ï¼šé€šè¿‡æ–‡æœ¬ç›¸ä¼¼åº¦åˆ¤æ–­æ£€ç´¢ç»“æœæ˜¯å¦å‘½ä¸­çœŸå®æ”¯æŒæ–‡æ¡£ï¼Œæ¨¡æ‹Ÿæ£€ç´¢è¯„ä¼°ï¼ˆå¦‚ Hit@k æŒ‡æ ‡ ï¼‰ã€‚  
   - `evaluate_generation`ï¼šè®¡ç®—ç”Ÿæˆå›ç­”ä¸çœŸå®ç­”æ¡ˆçš„æ–‡æœ¬ç›¸ä¼¼åº¦ï¼Œç®€å•æ¨¡æ‹Ÿç”Ÿæˆè¯„ä¼°ï¼ˆå®é™…å¯æ‰©å±•æ›´å¤šç»´åº¦ï¼Œå¦‚å¿ å®æ€§ã€å¯è¯»æ€§ ï¼‰ã€‚  
5. **ç«¯åˆ°ç«¯æ‰§è¡Œ**ï¼šéå† `golden_data`ï¼Œä¾æ¬¡æ‰§è¡Œâ€œæ£€ç´¢â†’æ£€ç´¢è¯„ä¼°â†’ç”Ÿæˆâ†’ç”Ÿæˆè¯„ä¼°â€ï¼Œè¾“å‡ºæ¯ä¸€æ­¥ç»“æœï¼Œå®Œæ•´æ¼”ç¤º RAG è¯„ä¼°æµç¨‹ã€‚  

å¯æ ¹æ®å®é™…éœ€æ±‚æ‰©å±•ï¼Œæ¯”å¦‚æ›¿æ¢ç”Ÿæˆé€»è¾‘ä¸ºçœŸå®å¤§æ¨¡å‹è°ƒç”¨ã€ä¼˜åŒ–è¯„ä¼°æŒ‡æ ‡ï¼ˆåŠ å…¥å¿ å®æ€§ã€å¯è¯»æ€§åˆ¤æ–­ ï¼‰ç­‰ã€‚


ä»¥ä¸‹æ˜¯æå–çš„å…¨éƒ¨æ–‡å­—å†…å®¹ï¼ŒæŒ‰æˆªå›¾é¡ºåºæ•´ç†ï¼š

### ç¬¬ä¸€ç»„æˆªå›¾ï¼ˆç¯å¢ƒä¸é¡¹ç›®å¼€å‘ï¼‰
#### 5.1 è®¾ç½®ç¯å¢ƒ  
é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ç¯å¢ƒã€‚  

##### 5.1.1 åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ  
ä½¿ç”¨ conda create æŒ‡ä»¤åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒ ragã€‚åˆ›å»ºè™šæ‹Ÿç¯å¢ƒçš„ç›®çš„æ˜¯ä¸ºäº†é¿å…ä¸åŒ python é¡¹ç›®å†²çªã€‚  

**ä»£ç å—**  
```
conda create -n rag python=3.11
```  

##### 5.1.2 æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ  
ï¼ˆæˆªå›¾ä¸­æœªå®Œæ•´æ˜¾ç¤ºï¼Œç»“åˆä¸Šä¸‹æ–‡æ¨æµ‹æ˜¯æ¿€æ´»è™šæ‹Ÿç¯å¢ƒçš„æŒ‡ä»¤ï¼Œå¦‚ `conda activate rag`  ï¼‰  


#### 5.2 å¼€å‘é¡¹ç›®  
æ•´ä¸ª RAG è¯„ä¼°å…¨æµç¨‹ä»£ç ï¼ŒåŒ…å«ä»¥ä¸‹æ¨¡å—ï¼š  
1. âœ… æ•°æ®å‡†å¤‡ï¼ˆé—®é¢˜ã€ç­”æ¡ˆã€æ”¯æŒæ–‡æ¡£ï¼‰  
2. ğŸ“¡ æ£€ç´¢æ¨¡å—ï¼ˆå‘é‡æ£€ç´¢æ¨¡æ‹Ÿï¼‰  
3. ğŸ“ ç”Ÿæˆæ¨¡å—ï¼ˆæ‹¼æ¥æ–‡æ¡£æ¨¡æ‹Ÿï¼‰  
4. ğŸ“Š è¯„ä¼°æ¨¡å—ï¼ˆæ£€ç´¢ hit å’Œç”Ÿæˆç›¸ä¼¼åº¦ï¼‰  
5. ğŸš€ ç«¯åˆ°ç«¯æ‰§è¡Œä¸è¾“å‡ºå±•ç¤º  

æ•´ä¸ªä»£ç å¦‚ä¸‹ï¼š  

**ä»£ç å—ï¼ˆPython ç¤ºä¾‹ï¼‰**  
```python
# RAG è¯„ä¼°å…¨æµç¨‹ä»£ç å®æˆ˜ï¼ˆåŸºäºã€Šå–œå‰§ä¹‹ç‹ã€‹ç¤ºä¾‹ï¼‰
from typing import List, Dict

# --- ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡æ•°æ®é›† ---
# ç¤ºä¾‹é»„é‡‘æ•°æ®é›†ï¼ˆé—®é¢˜+ç­”æ¡ˆ+æ”¯æŒæ–‡æ¡£ï¼‰
golden_data = [
    {
        "question": "ã€Šå–œå‰§ä¹‹ç‹ã€‹ä¸­æŸ³é£˜é£˜ä¸€å¤œæƒ…åå¯¹å°¹å¤©ä»‡è¯´äº†ä»€ä¹ˆï¼Ÿ",
        "answer": "åœ¨ç”µå½±ã€Šå–œå‰§ä¹‹ç‹ã€‹ä¸­ï¼Œä¸€å¤œæƒ…ä¹‹åï¼ŒæŸ³é£˜é£˜å¯¹å°¹å¤©ä»‡è¯´ï¼šâ€œä½ ä¸ä¼šçœŸçš„ä»¥ä¸ºæˆ‘å–œæ¬¢ä½ å§ï¼Ÿå¤§å®¶éƒ½æ˜¯æˆå¹´äººï¼Œç©ç©è€Œå·²ã€‚â€",
        "supporting_docs": [
            "ç¬¬äºŒå¤©æ¸…æ™¨ï¼ŒæŸ³é£˜é£˜çœ‹ç€å°¹å¤©ä»‡è¯´ï¼šâ€˜ä½ ä¸ä¼šçœŸçš„ä»¥ä¸ºæˆ‘å–œæ¬¢ä½ å§ï¼Ÿå¤§å®¶éƒ½æ˜¯æˆå¹´äººï¼Œç©ç©è€Œå·²ã€‚â€™",
            "å¥¹åˆ»æ„ç”¨è½»æ¾çš„è¯­æ°”æ©é¥°è‡ªå·±çš„å¤æ‚æƒ…ç»ªï¼Œè¯•å›¾æ‹‰å¼€è·ç¦»ã€‚"
        ]
    }
]

# --- ç¬¬äºŒæ­¥ï¼šæ£€ç´¢æ¨¡æ‹Ÿï¼ˆç®€å•è¯­ä¹‰åŒ¹é…ï¼‰ ---
from sklearn.metrics.pairwise import cosine_similarity
from sentence_transformers import SentenceTransformer
import numpy as np

# åˆå§‹åŒ–å‘é‡æ¨¡å‹
encoder = SentenceTransformer('all-MiniLM-L6-v2')

# æ¨¡æ‹ŸçŸ¥è¯†åº“ï¼ˆå‡è®¾å·²è¢«åˆ‡åˆ†æˆæ–‡æ¡£ç‰‡æ®µï¼‰
document_store = [
    "æŸ³é£˜é£˜ç¬¬ä¸€æ¬¡è§å°¹å¤©ä»‡æ˜¯åœ¨é…’å§çš„åå°ã€‚",
    "ç¬¬äºŒå¤©æ¸…æ™¨ï¼ŒæŸ³é£˜é£˜çœ‹ç€å°¹å¤©ä»‡è¯´ï¼šâ€˜ä½ ä¸ä¼šçœŸçš„ä»¥ä¸ºæˆ‘å–œæ¬¢ä½ å§ï¼Ÿå¤§å®¶éƒ½æ˜¯æˆå¹´äººï¼Œç©ç©è€Œå·²ã€‚â€™",
    "å°¹å¤©ä»‡æ¢¦æƒ³æˆä¸ºæ¼”å‘˜ï¼ŒåšæŒæ¯å¤©æ’ç»ƒå°è¯ã€‚",
    "å¥¹åˆ»æ„ç”¨è½»æ¾çš„è¯­æ°”æ©é¥°è‡ªå·±çš„å¤æ‚æƒ…ç»ªï¼Œè¯•å›¾æ‹‰å¼€è·ç¦»ã€‚"
]

def retrieve(question: str, top_k=3) -> List[str]:
    q_emb = encoder.encode([question])
    doc_embs = encoder.encode(document_store)
    scores = cosine_similarity(q_emb, doc_embs)[0]
    top_indices = scores.argsort()[::-1][:top_k]
    return [document_store[i] for i in top_indices]

# --- ç¬¬ä¸‰æ­¥ï¼šç”Ÿæˆæ¨¡æ‹Ÿï¼ˆç®€å•æ‹¼æ¥ï¼‰ ---
def generate_answer(retrieved_docs: List[str]) -> str:
    return "åŸºäºèµ„æ–™å›ç­”ï¼š" + " | ".join(retrieved_docs)

# --- ç¬¬å››æ­¥ï¼šè¯„ä¼° ---
from difflib import SequenceMatcher

def evaluate_retrieval(gt_docs: List[str], retrieved_docs: List[str]) -> float:
    hit = 0
    for gt in gt_docs:
        for r in retrieved_docs:
            if SequenceMatcher(None, gt, r).ratio() > 0.8:
                hit = 1
                break
        if hit:
            break
    return hit  # Hit@k

def evaluate_generation(golden: str, generated: str) -> float:
    return SequenceMatcher(None, golden, generated).ratio()  # ç²—ç•¥ç›¸ä¼¼åº¦è¯„ä¼°

# --- ç¬¬äº”æ­¥ï¼šè¿è¡Œå®Œæ•´æµç¨‹ ---
for sample in golden_data:
    question = sample["question"]
    gt_answer = sample["answer"]
    gt_docs = sample["supporting_docs"]
    
    print("\n=== é—®é¢˜ ===")
    print(question)
    
    retrieved = retrieve(question)
    print("\næ£€ç´¢ç»“æœï¼š")
    for d in retrieved:
        print("-", d)
    
    hit_score = evaluate_retrieval(gt_docs, retrieved)
    print(f"\næ£€ç´¢ Hit@k: {hit_score}")
    
    gen_answer = generate_answer(retrieved)
    print("\nç”Ÿæˆç­”æ¡ˆï¼š")
    print(gen_answer)
    
    gen_score = evaluate_generation(gt_answer, gen_answer)
    print(f"\nç”Ÿæˆç›¸ä¼¼åº¦å¾—åˆ†ï¼š{round(gen_score, 3)}")
```  

è‹¥è¿˜æœ‰å…¶ä»–é›¶æ•£æ–‡å­—ï¼ˆå¦‚æ“ä½œæç¤ºã€è¯´æ˜è¯­ï¼‰ï¼Œæœ¬è´¨å·²åŒ…å«åœ¨ä¸Šè¿°æµç¨‹å’Œä»£ç æ³¨é‡Šé‡Œï¼Œå¯ç»“åˆå®é™…æˆªå›¾æ ¸å¯¹ã€‚æ ¸å¿ƒæ˜¯å›´ç»• **RAG è¯„ä¼°å…¨æµç¨‹** çš„ä»£ç å®ç°ï¼Œä»æ•°æ®å‡†å¤‡ã€æ£€ç´¢/ç”Ÿæˆæ¨¡æ‹Ÿï¼Œåˆ°è¯„ä¼°ä¸ç«¯åˆ°ç«¯æ‰§è¡Œ ã€‚




# è¯„ä¼°æŒ‡æ ‡
æ£€ç´¢å™¨è¯„ä¼°æŒ‡æ ‡
## å‡†ç¡®ç‡ï¼š
context precision

t he signal to moise ratio of retrieved context

è¯„ä¼°æŸ¥è¯¢ç»“æœå‡†ä¸å‡†ç¡®
## å¬å›ç‡
ç³»ç»Ÿæ£€ç´¢å‡ºç›¸å…³çš„æ–‡æ¡£ï¼Œæ‰€æœ‰å®é™…ç›¸å…³çš„æ–‡æ¡£

context recall

can it retrieve all the relevant information required to answer the question

è¯„ä¼°æŸ¥è¯¢ç»“æœå…¨ä¸å…¨

## ç”Ÿæˆå™¨è¯„ä¼°æŒ‡æ ‡

## å¿ å®åº¦

æŒ‡çš„æ˜¯ç”Ÿæˆç»“æœæ˜¯åŸºäºæ£€ç´¢çš„ç»“æœï¼Œäº‹å®å‡†ç¡®çš„ï¼Œè¯„ä¼°ç”Ÿæˆå†…å®¹æ˜¯å¦æ˜¯è°è¨€

faithfulness

how factually acurate is the generated answer
## ç›¸å…³æ€§
answer relevancy

how relevant is the generated answer to the question




