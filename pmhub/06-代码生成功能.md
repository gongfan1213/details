# 代码生成功能

## 1. 功能概述

代码生成器模块（`pmhub-gen`）用于按照数据库表结构自动生成前后端基础代码，覆盖实体、Mapper、Service、Controller、前端表格与表单页面，显著提升研发效率，保持风格统一、规范一致。

## 2. 核心能力

- 表结构解析：支持 MySQL 表结构读取，识别主键、字段类型、索引、注释
- 模板渲染：后端（Java/Spring Boot/MyBatis-Plus）、前端（Vue2/Element-UI）
- 生成策略：主键策略、逻辑删除、时间字段、驼峰/下划线映射
- 代码下载：压缩包一键下载；或指定路径直接落盘
- 在线预览：生成前预览后端/前端各文件内容
- 二次开发：支持自定义模板与生成规则

## 3. 典型流程

1) 选择数据源与目标表 → 2) 配置生成策略（包名、作者、去前缀等） → 3) 预览文件 → 4) 下载或落盘 → 5) 导入项目编译运行

## 4. 技术方案

- 元数据获取：`information_schema` 查询表/列/索引元数据
- 模板引擎：Velocity/FreeMarker（项目中为 Velocity）
- ORM 约定：MyBatis-Plus 基础 CRUD + 分页 + 条件构造器
- 前端规范：列表页 + 查询条件 + 新增/编辑对话框 + 字典渲染

## 5. 关键配置项

- 包名与模块名：如 `com.laigeoffer.pmhub.modules.demo`
- 去表前缀：`sys_`, `wf_`, `project_` 等
- 主键策略：雪花/自增/自定义
- 逻辑删除：字段名、删除值/未删值
- 审计字段：`create_time`,`update_time`,`create_by`,`update_by`

## 6. 生成内容清单

- 后端：Entity、Mapper（xml/注解）、Service/Impl、Controller、DTO/VO
- 前端：`api/*.js`、`views/*/index.vue`（列表/表单）、`router` 配置片段
- SQL：示例数据或变更脚本（可选）

## 7. 最佳实践与限制

- 只生成“样板代码”，业务逻辑需二开
- 统一规范后再生成，避免重复调整
- 对历史表慎用“覆盖”，建议生成到临时目录对比合并

## 8. 常见问题

- 生成字段类型不匹配：检查自定义类型映射表
- 前端字典未渲染：确认字典类型是否已在系统字典中配置
- 控制器权限标识冲突：调整 `@RequiresPermissions` 的 `perms` 字符串

## 9. 扩展点

- 新增模板集合：如 Vue3+Vite、前后端分离 API 文档增强
- 多数据源支持：在选择表前切换数据源
- DSL 驱动：用 YAML/JSON 描述领域模型直接生成表和代码
