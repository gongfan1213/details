# 监控与可观测性

## 1. 概述

监控中心（`pmhub-monitor`）基于 Spring Boot Admin，配合 Actuator、日志聚合与 SkyWalking，构建覆盖应用、业务与基础设施的可观测体系。

## 2. 监控范围

- 应用监控：实例健康、线程/堆、GC、HTTP 指标
- 业务监控：项目/任务数量、审批 Throughput
- 基础设施：MySQL/Redis/MQ 指标（可对接 Prometheus）
- 链路追踪：SkyWalking Trace/Span，异常火焰图

## 3. 技术组件

- Spring Boot Actuator：`/actuator/**`
- Spring Boot Admin：实例注册、在线查看日志/线程/环境
- SkyWalking Agent：无侵入埋点
- 日志：JSON 日志 + TraceId 贯穿

## 4. 告警与自愈

- 告警规则：错误率、RT、实例离线、队列堆积
- 通知渠道：站内信/邮件/企业微信（二开）
- 自愈动作：自动扩容、重启、降级开关（配置化）

## 5. 常见问题

- 无法注册到 Admin：检查 Actuator 暴露与安全设置
- Trace 丢失：确认网关与下游均透传 `traceId`
- 指标缺失：确认端点是否开启且未被网关拦截

## 6. 最佳实践

- 统一日志规范：`traceId,userId,uri,cost,code`
- 指标分层：系统/应用/业务三级
- 基于看板运维：按服务/环境/版本划分大盘
